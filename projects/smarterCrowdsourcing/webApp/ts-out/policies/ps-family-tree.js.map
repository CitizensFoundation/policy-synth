{"version":3,"file":"ps-family-tree.js","sourceRoot":"","sources":["../../src/policies/ps-family-tree.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html, nothing } from 'lit';\nimport { property, customElement } from 'lit/decorators.js';\n\nimport '@yrpri/webapp/common/yp-image.js';\n\nimport { PsStageBase } from '../base/ps-stage-base.js';\nimport { Layouts } from '../flexbox-literals/classes.js';\nimport { YpBaseElement } from '@yrpri/webapp/common/yp-base-element.js';\n\n@customElement('ps-family-tree')\nexport class PsFamilyTree extends YpBaseElement {\n  @property({ type: Object })\n  memory!: PsSmarterCrowdsourcingMemoryData;\n\n  @property({ type: Number })\n  subProblemIndex!: number;\n\n  @property({ type: Object })\n  solution!: PsSolution;\n\n  async connectedCallback() {\n    super.connectedCallback();\n    window.psAppGlobals.activity(`Family tree - open`);\n  }\n\n  disconnectedCallback(): void {\n    super.disconnectedCallback();\n    window.psAppGlobals.activity(`Family tree - close`);\n  }\n\n  static get styles() {\n    return [\n      super.styles,\n      Layouts,\n      css`\n        :host {\n        }\n        .tree-structure {\n          color: var(--md-sys-color-primary);\n        }\n\n        .treeContainer {\n          box-sizing: border-box;\n          overflow-x: auto;\n          max-width: 100%;\n          width: 100%;\n          margin: 0 auto;\n        }\n\n        @media (max-width: 600px) {\n          .treeContainer {\n            width: 100%;\n            max-width: 100%;\n          }\n        }\n\n        .family-level {\n          display: flex;\n          flex-direction: row;\n          margin: 8px;\n          margin-top: 6px;\n          align-items: start;\n          min-width: 220px;\n          max-width: 100%;\n        }\n\n        .family-box {\n          border: 1px solid var(--md-sys-color-secondary);\n          padding: 10px;\n          margin: 5px;\n          border-radius: 8px;\n          max-width: 320px;\n        }\n        .solution-box {\n          padding: 10px;\n          margin: 5px;\n        }\n        .url-link {\n          display: block;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          max-width: 60ch;\n          color: var(--md-sys-color-on-primary-container);\n        }\n        a {\n          color: var(--md-sys-color-on-primary-container);\n        }\n\n        .familyTreeTitle {\n          padding: 16px;\n          font-size: 26px;\n          color: var(--md-sys-color-primary);\n          background-color: var(--md-sys-color-on-primary);\n          border-radius: 16px;\n          margin: 16px;\n          margin-bottom: 24px;\n          width: 100%;\n          max-width: 320px;\n          text-align: center;\n          text-transform: uppercase;\n          font-family: 'Cabin', sans-serif;\n        }\n\n        .solution-title {\n          font-size: 1.2em;\n          padding: 5px;\n          border-radius: 5px;\n          margin-bottom: 10px;\n        }\n\n        .generation {\n          font-size: 0.43em;\n          margin-left: 1px;\n          opacity: 0.75;\n        }\n\n        .parent-container {\n          align-items: start !important;\n        }\n\n        .no-parent {\n          background-color: var(--md-sys-color-surface-variant);\n          color: var(--md-sys-color-on-surface-variant);\n        }\n\n        .is-mutated-from {\n          background-color: var(--md-sys-color-secondary-container);\n          color: var(--md-sys-color-on-secondary-container);\n        }\n        .seed-url-parent {\n          background-color: var(--md-sys-color-primary-container);\n          color: var(--md-sys-color-on-primary-container);\n        }\n\n        .first {\n          background-color: var(--md-sys-color-tertiary-container);\n          color: var(--md-sys-color-on-tertiary-container);\n        }\n\n        .mutationRate {\n          text-transform: capitalize;\n        }\n\n        .familyIcon {\n          margin-top: 40px;\n          margin-bottom: 8px;\n          font-size: 48px;\n          color: var(--md-sys-color-primary);\n        }\n\n        @media (max-width: 600px) {\n          .url-link {\n            max-width: 25ch;\n          }\n\n          .family-box {\n          }\n\n          .family-level {\n            max-width: 360px;\n          }\n\n          .treeContainer {\n            max-width: 360px;\n          }\n\n          .familyTreeTitle {\n          }\n\n          .treeContainer {\n          }\n        }\n      `,\n    ];\n  }\n\n  getParentSolution(parent: string): PsSolution {\n    const splitParentIndex = parent.split(':');\n    const populationIndex = parseInt(splitParentIndex[0]);\n    const solutionIndex = parseInt(splitParentIndex[1]);\n\n    return this.memory.subProblems[this.subProblemIndex].solutions.populations[\n      populationIndex\n    ][solutionIndex];\n  }\n\n  renderFamilyTree(\n    currentSolution: PsSolution,\n    first = false,\n    isMutatedFrom = false\n  ): any {\n    const hasParentB = currentSolution.family?.parentB ? true : false;\n    return html`\n      <div class=\"tree-structure layout vertical center-center\">\n        <div\n          class=\"family-level layout vertical center-center\"\n          data-scrollable=\"true\"\n        >\n          <div\n            class=\"family-box ${first ? 'first' : ''} ${!currentSolution.family\n              ? 'no-parent'\n              : ''} ${isMutatedFrom\n              ? 'is-mutated-from'\n              : ''} ${!currentSolution.family\n              ? 'no-parent'\n              : ''} ${currentSolution.family?.seedUrls &&\n            !currentSolution.family.parentA &&\n            !currentSolution.family.parentB\n              ? 'seed-url-parent'\n              : ''}\"\n          >\n            <div class=\"solution-title\" ?first=\"${first}\">\n              ${currentSolution.title}\n              ${currentSolution.family?.gen !== undefined\n                ? html`<span class=\"generation\"\n                    >(${currentSolution.family.gen + 1})</span\n                  >`\n                : ''}\n            </div>\n\n            ${!currentSolution.family\n              ? html`<div class=\"layout horizontal center-center\">\n                  ... parent data not collected\n                </div>`\n              : html`\n                  ${currentSolution.family.mutationRate\n                    ? html`<div>\n                        Mutation rate:\n                        <span class=\"mutationRate\"\n                          >${currentSolution.family.mutationRate}</span\n                        >\n                      </div>`\n                    : ''}\n                  ${currentSolution.family.seedUrls &&\n                  currentSolution.family.seedUrls.length > 0\n                    ? html`\n                        <div class=\"solution-box\">\n                          Seed URLs:\n                          ${currentSolution.family.seedUrls.map(\n                            url =>\n                              html`<a\n                                href=\"${url}\"\n                                target=\"_blank\"\n                                class=\"url-link\"\n                                >${url}</a\n                              >`\n                          )}\n                        </div>\n                      `\n                    : ''}\n                `}\n          </div>\n        </div>\n\n        <div\n          class=\"layout ${hasParentB\n            ? 'horizontal'\n            : 'vertical'} center-center parent-container\"\n        >\n          <div\n            class=\"family-level ${hasParentB ? 'two-parents' : ''}\"\n            data-scrollable=\"true\"\n          >\n            ${currentSolution.family?.parentA\n              ? html`\n                  ${this.renderFamilyTree(\n                    this.getParentSolution(currentSolution.family.parentA),\n                    false,\n                    !hasParentB\n                  )}\n                `\n              : ''}\n            ${currentSolution.family?.parentB\n              ? html`\n                  ${this.renderFamilyTree(\n                    this.getParentSolution(currentSolution.family.parentB)\n                  )}\n                `\n              : ''}\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  render() {\n    return html`\n      <div class=\"layout vertical center-center\">\n        <md-icon class=\"familyIcon\">family_history</md-icon>\n        <div class=\"familyTreeTitle\">${this.t('Evolutionary Tree')}</div>\n        <div class=\"treeContainer\" data-scrollable=\"true\">\n          ${this.renderFamilyTree(this.solution, true)}\n        </div>\n      </div>\n    `;\n  }\n}\n"]}