var e=Object.defineProperty,t=(t,r)=>e(t,"name",{value:r,configurable:!0}),r=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(e,t,r,s,i,n){this.type=e,this.name=t,this.prefix=r,this.value=s,this.suffix=i,this.modifier=n}hasCustomName(){return""!==this.name&&"number"!=typeof this.name}};t(r,"Part");var s=/[$_\p{ID_Start}]/u,i=/[$_\u200C\u200D\p{ID_Continue}]/u,n=".*";function a(e,t){return(t?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(e)}function o(e,r=!1){let n=[],o=0;for(;o<e.length;){let h=e[o],p=t((function(t){if(!r)throw new TypeError(t);n.push({type:"INVALID_CHAR",index:o,value:e[o++]})}),"ErrorOrInvalid");if("*"!==h)if("+"!==h&&"?"!==h)if("\\"!==h)if("{"!==h)if("}"!==h)if(":"!==h)if("("!==h)n.push({type:"CHAR",index:o,value:e[o++]});else{let t=1,r="",s=o+1,i=!1;if("?"===e[s]){p(`Pattern cannot start with "?" at ${s}`);continue}for(;s<e.length;){if(!a(e[s],!1)){p(`Invalid character '${e[s]}' at ${s}.`),i=!0;break}if("\\"!==e[s]){if(")"===e[s]){if(t--,0===t){s++;break}}else if("("===e[s]&&(t++,"?"!==e[s+1])){p(`Capturing groups are not allowed at ${s}`),i=!0;break}r+=e[s++]}else r+=e[s++]+e[s++]}if(i)continue;if(t){p(`Unbalanced pattern at ${o}`);continue}if(!r){p(`Missing pattern at ${o}`);continue}n.push({type:"REGEX",index:o,value:r}),o=s}else{let t="",r=o+1;for(;r<e.length;){let n=e.substr(r,1);if(!(r===o+1&&s.test(n)||r!==o+1&&i.test(n)))break;t+=e[r++]}if(!t){p(`Missing parameter name at ${o}`);continue}n.push({type:"NAME",index:o,value:t}),o=r}else n.push({type:"CLOSE",index:o,value:e[o++]});else n.push({type:"OPEN",index:o,value:e[o++]});else n.push({type:"ESCAPED_CHAR",index:o++,value:e[o++]});else n.push({type:"OTHER_MODIFIER",index:o,value:e[o++]});else n.push({type:"ASTERISK",index:o,value:e[o++]})}return n.push({type:"END",index:o,value:""}),n}function h(e,s={}){let i=o(e);s.delimiter??="/#?",s.prefixes??="./";let a=`[^${p(s.delimiter)}]+?`,h=[],u=0,c=0,l=new Set,f=t((e=>{if(c<i.length&&i[c].type===e)return i[c++].value}),"tryConsume"),m=t((()=>f("OTHER_MODIFIER")??f("ASTERISK")),"tryConsumeModifier"),d=t((e=>{let t=f(e);if(void 0!==t)return t;let{type:r,index:s}=i[c];throw new TypeError(`Unexpected ${r} at ${s}, expected ${e}`)}),"mustConsume"),g=t((()=>{let e,t="";for(;e=f("CHAR")??f("ESCAPED_CHAR");)t+=e;return t}),"consumeText"),y=t((e=>e),"DefaultEncodePart"),w=s.encodePart||y,b="",v=t((e=>{b+=e}),"appendToPendingFixedValue"),x=t((()=>{b.length&&(h.push(new r(3,"","",w(b),"",3)),b="")}),"maybeAddPartFromPendingFixedValue"),E=t(((e,t,s,i,o)=>{let p,c=3;switch(o){case"?":c=1;break;case"*":c=0;break;case"+":c=2}if(!t&&!s&&3===c)return void v(e);if(x(),!t&&!s){if(!e)return;return void h.push(new r(3,"","",w(e),"",c))}p=s?"*"===s?n:s:a;let f,m=2;if(p===a?(m=1,p=""):p===n&&(m=0,p=""),t?f=t:s&&(f=u++),l.has(f))throw new TypeError(`Duplicate name '${f}'.`);l.add(f),h.push(new r(m,f,w(e),p,w(i),c))}),"addPart");for(;c<i.length;){let e=f("CHAR"),t=f("NAME"),r=f("REGEX");if(!t&&!r&&(r=f("ASTERISK")),t||r){let i=e??"";-1===s.prefixes.indexOf(i)&&(v(i),i=""),x(),E(i,t,r,"",m());continue}let i=e??f("ESCAPED_CHAR");if(i)v(i);else if(f("OPEN")){let e=g(),t=f("NAME"),r=f("REGEX");!t&&!r&&(r=f("ASTERISK"));let s=g();d("CLOSE"),E(e,t,r,s,m())}else x(),d("END")}return h}function p(e){return e.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function u(e){return e&&e.ignoreCase?"ui":"u"}function c(e,t,r){return f(h(e,r),t,r)}function l(e){switch(e){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}function f(e,t,r={}){r.delimiter??="/#?",r.prefixes??="./",r.sensitive??=!1,r.strict??=!1,r.end??=!0,r.start??=!0,r.endsWith="";let s=r.start?"^":"";for(let i of e){if(3===i.type){3===i.modifier?s+=p(i.value):s+=`(?:${p(i.value)})${l(i.modifier)}`;continue}t&&t.push(i.name);let e=`[^${p(r.delimiter)}]+?`,a=i.value;(1===i.type?a=e:0===i.type&&(a=n),i.prefix.length||i.suffix.length)?3!==i.modifier&&1!==i.modifier?(s+=`(?:${p(i.prefix)}`,s+=`((?:${a})(?:`,s+=p(i.suffix),s+=p(i.prefix),s+=`(?:${a}))*)${p(i.suffix)})`,0===i.modifier&&(s+="?")):(s+=`(?:${p(i.prefix)}(${a})${p(i.suffix)})`,s+=l(i.modifier)):3===i.modifier||1===i.modifier?s+=`(${a})${l(i.modifier)}`:s+=`((?:${a})${l(i.modifier)})`}let i=`[${p(r.endsWith)}]|$`,a=`[${p(r.delimiter)}]`;if(r.end)return r.strict||(s+=`${a}?`),r.endsWith.length?s+=`(?=${i})`:s+="$",new RegExp(s,u(r));r.strict||(s+=`(?:${a}(?=${i}))?`);let o=!1;if(e.length){let t=e[e.length-1];3===t.type&&3===t.modifier&&(o=r.delimiter.indexOf(t)>-1)}return o||(s+=`(?=${a}|${i})`),new RegExp(s,u(r))}t(a,"isASCII"),t(o,"lexer"),t(h,"parse"),t(p,"escapeString"),t(u,"flags"),t(c,"stringToRegexp"),t(l,"modifierToString"),t(f,"partsToRegexp");var m={delimiter:"",prefixes:"",sensitive:!0,strict:!0},d={delimiter:".",prefixes:"",sensitive:!0,strict:!0},g={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function y(e,t){return!!e.length&&("/"===e[0]||!(!t||e.length<2)&&(("\\"==e[0]||"{"==e[0])&&"/"==e[1]))}function w(e,t){return e.startsWith(t)?e.substring(t.length,e.length):e}function b(e,t){return e.endsWith(t)?e.substr(0,e.length-t.length):e}function v(e){return!(!e||e.length<2)&&("["===e[0]||("\\"===e[0]||"{"===e[0])&&"["===e[1])}t(y,"isAbsolutePathname"),t(w,"maybeStripPrefix"),t(b,"maybeStripSuffix"),t(v,"treatAsIPv6Hostname");var x=["ftp","file","http","https","ws","wss"];function E(e){if(!e)return!0;for(let t of x)if(e.test(t))return!0;return!1}function $(e,t){if(e=w(e,"#"),t||""===e)return e;let r=new URL("https://example.com");return r.hash=e,r.hash?r.hash.substring(1,r.hash.length):""}function R(e,t){if(e=w(e,"?"),t||""===e)return e;let r=new URL("https://example.com");return r.search=e,r.search?r.search.substring(1,r.search.length):""}function P(e,t){return t||""===e?e:v(e)?H(e):D(e)}function C(e,t){if(t||""===e)return e;let r=new URL("https://example.com");return r.password=e,r.password}function k(e,t){if(t||""===e)return e;let r=new URL("https://example.com");return r.username=e,r.username}function L(e,t,r){if(r||""===e)return e;if(t&&!x.includes(t))return new URL(`${t}:${e}`).pathname;let s="/"==e[0];return e=new URL(s?e:"/-"+e,"https://example.com").pathname,s||(e=e.substring(2,e.length)),e}function S(e,t,r){return T(t)===e&&(e=""),r||""===e?e:N(e)}function A(e,t){return e=b(e,":"),t||""===e?e:U(e)}function T(e){switch(e){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}function U(e){if(""===e)return e;if(/^[-+.A-Za-z0-9]*$/.test(e))return e.toLowerCase();throw new TypeError(`Invalid protocol '${e}'.`)}function I(e){if(""===e)return e;let t=new URL("https://example.com");return t.username=e,t.username}function O(e){if(""===e)return e;let t=new URL("https://example.com");return t.password=e,t.password}function D(e){if(""===e)return e;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(e))throw new TypeError(`Invalid hostname '${e}'`);let t=new URL("https://example.com");return t.hostname=e,t.hostname}function H(e){if(""===e)return e;if(/[^0-9a-fA-F[\]:]/g.test(e))throw new TypeError(`Invalid IPv6 hostname '${e}'`);return e.toLowerCase()}function N(e){if(""===e||/^[0-9]*$/.test(e)&&parseInt(e)<=65535)return e;throw new TypeError(`Invalid port '${e}'.`)}function j(e){if(""===e)return e;let t=new URL("https://example.com");return t.pathname="/"!==e[0]?"/-"+e:e,"/"!==e[0]?t.pathname.substring(2,t.pathname.length):t.pathname}function _(e){return""===e?e:new URL(`data:${e}`).pathname}function F(e){if(""===e)return e;let t=new URL("https://example.com");return t.search=e,t.search.substring(1,t.search.length)}function M(e){if(""===e)return e;let t=new URL("https://example.com");return t.hash=e,t.hash.substring(1,t.hash.length)}t(E,"isSpecialScheme"),t($,"canonicalizeHash"),t(R,"canonicalizeSearch"),t(P,"canonicalizeHostname"),t(C,"canonicalizePassword"),t(k,"canonicalizeUsername"),t(L,"canonicalizePathname"),t(S,"canonicalizePort"),t(A,"canonicalizeProtocol"),t(T,"defaultPortForProtocol"),t(U,"protocolEncodeCallback"),t(I,"usernameEncodeCallback"),t(O,"passwordEncodeCallback"),t(D,"hostnameEncodeCallback"),t(H,"ipv6HostnameEncodeCallback"),t(N,"portEncodeCallback"),t(j,"standardURLPathnameEncodeCallback"),t(_,"pathURLPathnameEncodeCallback"),t(F,"searchEncodeCallback"),t(M,"hashEncodeCallback");var z=class{#e;#t=[];#r={};#s=0;#i=1;#n=0;#a=0;#o=0;#h=0;#p=!1;constructor(e){this.#e=e}get result(){return this.#r}parse(){for(this.#t=o(this.#e,!0);this.#s<this.#t.length;this.#s+=this.#i){if(this.#i=1,"END"===this.#t[this.#s].type){if(0===this.#a){this.#u(),this.#c()?this.#l(9,1):this.#f()?this.#l(8,1):this.#l(7,0);continue}if(2===this.#a){this.#m(5);continue}this.#l(10,0);break}if(this.#o>0){if(!this.#d())continue;this.#o-=1}if(this.#g())this.#o+=1;else switch(this.#a){case 0:this.#y()&&this.#m(1);break;case 1:if(this.#y()){this.#w();let e=7,t=1;this.#b()?(e=2,t=3):this.#p&&(e=2),this.#l(e,t)}break;case 2:this.#v()?this.#m(3):(this.#x()||this.#f()||this.#c())&&this.#m(5);break;case 3:this.#E()?this.#l(4,1):this.#v()&&this.#l(5,1);break;case 4:this.#v()&&this.#l(5,1);break;case 5:this.#$()?this.#h+=1:this.#R()&&(this.#h-=1),this.#P()&&!this.#h?this.#l(6,1):this.#x()?this.#l(7,0):this.#f()?this.#l(8,1):this.#c()&&this.#l(9,1);break;case 6:this.#x()?this.#l(7,0):this.#f()?this.#l(8,1):this.#c()&&this.#l(9,1);break;case 7:this.#f()?this.#l(8,1):this.#c()&&this.#l(9,1);break;case 8:this.#c()&&this.#l(9,1)}}void 0!==this.#r.hostname&&void 0===this.#r.port&&(this.#r.port="")}#l(e,t){switch(this.#a){case 0:case 2:break;case 1:this.#r.protocol=this.#C();break;case 3:this.#r.username=this.#C();break;case 4:this.#r.password=this.#C();break;case 5:this.#r.hostname=this.#C();break;case 6:this.#r.port=this.#C();break;case 7:this.#r.pathname=this.#C();break;case 8:this.#r.search=this.#C();break;case 9:this.#r.hash=this.#C()}0!==this.#a&&10!==e&&([1,2,3,4].includes(this.#a)&&[6,7,8,9].includes(e)&&(this.#r.hostname??=""),[1,2,3,4,5,6].includes(this.#a)&&[8,9].includes(e)&&(this.#r.pathname??=this.#p?"/":""),[1,2,3,4,5,6,7].includes(this.#a)&&9===e&&(this.#r.search??="")),this.#k(e,t)}#k(e,t){this.#a=e,this.#n=this.#s+t,this.#s+=t,this.#i=0}#u(){this.#s=this.#n,this.#i=0}#m(e){this.#u(),this.#a=e}#L(e){return e<0&&(e=this.#t.length-e),e<this.#t.length?this.#t[e]:this.#t[this.#t.length-1]}#S(e,t){let r=this.#L(e);return r.value===t&&("CHAR"===r.type||"ESCAPED_CHAR"===r.type||"INVALID_CHAR"===r.type)}#y(){return this.#S(this.#s,":")}#b(){return this.#S(this.#s+1,"/")&&this.#S(this.#s+2,"/")}#v(){return this.#S(this.#s,"@")}#E(){return this.#S(this.#s,":")}#P(){return this.#S(this.#s,":")}#x(){return this.#S(this.#s,"/")}#f(){if(this.#S(this.#s,"?"))return!0;if("?"!==this.#t[this.#s].value)return!1;let e=this.#L(this.#s-1);return"NAME"!==e.type&&"REGEX"!==e.type&&"CLOSE"!==e.type&&"ASTERISK"!==e.type}#c(){return this.#S(this.#s,"#")}#g(){return"OPEN"==this.#t[this.#s].type}#d(){return"CLOSE"==this.#t[this.#s].type}#$(){return this.#S(this.#s,"[")}#R(){return this.#S(this.#s,"]")}#C(){let e=this.#t[this.#s],t=this.#L(this.#n).index;return this.#e.substring(t,e.index)}#w(){let e={};Object.assign(e,m),e.encodePart=U;let t=c(this.#C(),void 0,e);this.#p=E(t)}};t(z,"Parser");var W=["protocol","username","password","hostname","port","pathname","search","hash"],G="*";function K(e,t){if("string"!=typeof e)throw new TypeError("parameter 1 is not of type 'string'.");let r=new URL(e,t);return{protocol:r.protocol.substring(0,r.protocol.length-1),username:r.username,password:r.password,hostname:r.hostname,port:r.port,pathname:r.pathname,search:""!==r.search?r.search.substring(1,r.search.length):void 0,hash:""!==r.hash?r.hash.substring(1,r.hash.length):void 0}}function V(e,t){return t?B(e):e}function X(e,t,r){let s;if("string"==typeof t.baseURL)try{s=new URL(t.baseURL),void 0===t.protocol&&(e.protocol=V(s.protocol.substring(0,s.protocol.length-1),r)),!r&&void 0===t.protocol&&void 0===t.hostname&&void 0===t.port&&void 0===t.username&&(e.username=V(s.username,r)),!r&&void 0===t.protocol&&void 0===t.hostname&&void 0===t.port&&void 0===t.username&&void 0===t.password&&(e.password=V(s.password,r)),void 0===t.protocol&&void 0===t.hostname&&(e.hostname=V(s.hostname,r)),void 0===t.protocol&&void 0===t.hostname&&void 0===t.port&&(e.port=V(s.port,r)),void 0===t.protocol&&void 0===t.hostname&&void 0===t.port&&void 0===t.pathname&&(e.pathname=V(s.pathname,r)),void 0===t.protocol&&void 0===t.hostname&&void 0===t.port&&void 0===t.pathname&&void 0===t.search&&(e.search=V(s.search.substring(1,s.search.length),r)),void 0===t.protocol&&void 0===t.hostname&&void 0===t.port&&void 0===t.pathname&&void 0===t.search&&void 0===t.hash&&(e.hash=V(s.hash.substring(1,s.hash.length),r))}catch{throw new TypeError(`invalid baseURL '${t.baseURL}'.`)}if("string"==typeof t.protocol&&(e.protocol=A(t.protocol,r)),"string"==typeof t.username&&(e.username=k(t.username,r)),"string"==typeof t.password&&(e.password=C(t.password,r)),"string"==typeof t.hostname&&(e.hostname=P(t.hostname,r)),"string"==typeof t.port&&(e.port=S(t.port,e.protocol,r)),"string"==typeof t.pathname){if(e.pathname=t.pathname,s&&!y(e.pathname,r)){let t=s.pathname.lastIndexOf("/");t>=0&&(e.pathname=V(s.pathname.substring(0,t+1),r)+e.pathname)}e.pathname=L(e.pathname,e.protocol,r)}return"string"==typeof t.search&&(e.search=R(t.search,r)),"string"==typeof t.hash&&(e.hash=$(t.hash,r)),e}function B(e){return e.replace(/([+*?:{}()\\])/g,"\\$1")}function Z(e){return e.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function q(e,t){t.delimiter??="/#?",t.prefixes??="./",t.sensitive??=!1,t.strict??=!1,t.end??=!0,t.start??=!0,t.endsWith="";let r=`[^${Z(t.delimiter)}]+?`,s=/[$_\u200C\u200D\p{ID_Continue}]/u,i="";for(let n=0;n<e.length;++n){let a=e[n];if(3===a.type){if(3===a.modifier){i+=B(a.value);continue}i+=`{${B(a.value)}}${l(a.modifier)}`;continue}let o=a.hasCustomName(),h=!!a.suffix.length||!!a.prefix.length&&(1!==a.prefix.length||!t.prefixes.includes(a.prefix)),p=n>0?e[n-1]:null,u=n<e.length-1?e[n+1]:null;if(!h&&o&&1===a.type&&3===a.modifier&&u&&!u.prefix.length&&!u.suffix.length)if(3===u.type){let e=u.value.length>0?u.value[0]:"";h=s.test(e)}else h=!u.hasCustomName();if(!h&&!a.prefix.length&&p&&3===p.type){let e=p.value[p.value.length-1];h=t.prefixes.includes(e)}h&&(i+="{"),i+=B(a.prefix),o&&(i+=`:${a.name}`),2===a.type?i+=`(${a.value})`:1===a.type?o||(i+=`(${r})`):0===a.type&&(o||p&&3!==p.type&&3===p.modifier&&!h&&""===a.prefix?i+="(.*)":i+="*"),1===a.type&&o&&a.suffix.length&&s.test(a.suffix[0])&&(i+="\\"),i+=B(a.suffix),h&&(i+="}"),3!==a.modifier&&(i+=l(a.modifier))}return i}t(K,"extractValues"),t(V,"processBaseURLString"),t(X,"applyInit"),t(B,"escapePatternString"),t(Z,"escapeRegexpString"),t(q,"partsToPattern");var J=class{#e;#t={};#r={};#s={};#i={};#n=!1;constructor(e={},t,r){try{let s;if("string"==typeof t?s=t:r=t,"string"==typeof e){let t=new z(e);if(t.parse(),e=t.result,void 0===s&&"string"!=typeof e.protocol)throw new TypeError("A base URL must be provided for a relative constructor string.");e.baseURL=s}else{if(!e||"object"!=typeof e)throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(s)throw new TypeError("parameter 1 is not of type 'string'.")}typeof r>"u"&&(r={ignoreCase:!1});let i,n={ignoreCase:!0===r.ignoreCase},a={pathname:G,protocol:G,username:G,password:G,hostname:G,port:G,search:G,hash:G};for(i of(this.#e=X(a,e,!0),T(this.#e.protocol)===this.#e.port&&(this.#e.port=""),W)){if(!(i in this.#e))continue;let e={},t=this.#e[i];switch(this.#r[i]=[],i){case"protocol":Object.assign(e,m),e.encodePart=U;break;case"username":Object.assign(e,m),e.encodePart=I;break;case"password":Object.assign(e,m),e.encodePart=O;break;case"hostname":Object.assign(e,d),v(t)?e.encodePart=H:e.encodePart=D;break;case"port":Object.assign(e,m),e.encodePart=N;break;case"pathname":E(this.#t.protocol)?(Object.assign(e,g,n),e.encodePart=j):(Object.assign(e,m,n),e.encodePart=_);break;case"search":Object.assign(e,m,n),e.encodePart=F;break;case"hash":Object.assign(e,m,n),e.encodePart=M}try{this.#i[i]=h(t,e),this.#t[i]=f(this.#i[i],this.#r[i],e),this.#s[i]=q(this.#i[i],e),this.#n=this.#n||this.#i[i].some((e=>2===e.type))}catch{throw new TypeError(`invalid ${i} pattern '${this.#e[i]}'.`)}}}catch(e){throw new TypeError(`Failed to construct 'URLPattern': ${e.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(e={},t){let r,s={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if("string"!=typeof e&&t)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof e>"u")return!1;try{s=X(s,"object"==typeof e?e:K(e,t),!1)}catch{return!1}for(r of W)if(!this.#t[r].exec(s[r]))return!1;return!0}exec(e={},t){let r={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if("string"!=typeof e&&t)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof e>"u")return;try{r=X(r,"object"==typeof e?e:K(e,t),!1)}catch{return null}let s,i={};for(s of(i.inputs=t?[e,t]:[e],W)){let e=this.#t[s].exec(r[s]);if(!e)return null;let t={};for(let[r,i]of this.#r[s].entries())if("string"==typeof i||"number"==typeof i){let s=e[r+1];t[i]=s}i[s]={input:r[s]??"",groups:t}}return i}static compareComponent(e,s,i){let n=t(((e,t)=>{for(let r of["type","modifier","prefix","value","suffix"]){if(e[r]<t[r])return-1;if(e[r]!==t[r])return 1}return 0}),"comparePart"),a=new r(3,"","","","",3),o=new r(0,"","","","",3),h=t(((e,t)=>{let r=0;for(;r<Math.min(e.length,t.length);++r){let s=n(e[r],t[r]);if(s)return s}return e.length===t.length?0:n(e[r]??a,t[r]??a)}),"comparePartList");return s.#s[e]||i.#s[e]?s.#s[e]&&!i.#s[e]?h(s.#i[e],[o]):!s.#s[e]&&i.#s[e]?h([o],i.#i[e]):h(s.#i[e],i.#i[e]):0}get protocol(){return this.#s.protocol}get username(){return this.#s.username}get password(){return this.#s.password}get hostname(){return this.#s.hostname}get port(){return this.#s.port}get pathname(){return this.#s.pathname}get search(){return this.#s.search}get hash(){return this.#s.hash}get hasRegExpGroups(){return this.#n}};t(J,"URLPattern"),globalThis.URLPattern||(globalThis.URLPattern=J);export{J as URLPattern};
