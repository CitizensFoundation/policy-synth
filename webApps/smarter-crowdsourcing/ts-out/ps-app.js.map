{"version":3,"file":"ps-app.js","sourceRoot":"","sources":["../src/ps-app.ts"],"names":[],"mappings":";;;;;;AAAA,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,OAAO,EAAkB,MAAM,KAAK,CAAC;AACzD,OAAO,EAAE,QAAQ,EAAE,aAAa,EAAS,MAAM,mBAAmB,CAAC;AACnE,OAAO,qBAAqB,CAAC;AAE7B,OAAO,oDAAoD,CAAC;AAC5D,OAAO,oDAAoD,CAAC;AAC5D,mFAAmF;AACnF,OAAO,0DAA0D,CAAC;AAClE,OAAO,iCAAiC,CAAC;AACzC,OAAO,4BAA4B,CAAC;AACpC,OAAO,4BAA4B,CAAC;AACpC,OAAO,yCAAyC,CAAC;AACjD,OAAO,kDAAkD,CAAC;AAC1D,OAAO,wCAAwC,CAAC;AAEhD,OAAO,EACL,UAAU,EACV,WAAW,EACX,oBAAoB,GACrB,MAAM,oCAAoC,CAAC;AAE5C,OAAO,4BAA4B,CAAC;AAGpC,OAAO,kCAAkC,CAAC;AAE1C,uCAAuC;AACvC,OAAO,EAAE,OAAO,EAAE,MAAM,+BAA+B,CAAC;AAExD,OAAO,+BAA+B,CAAC;AAEvC,OAAO,EAAE,WAAW,EAAE,MAAM,uBAAuB,CAAC;AACpD,OAAO,EAAE,YAAY,EAAE,MAAM,wBAAwB,CAAC;AAKtD,OAAO,EAAE,SAAS,EAAE,MAAM,qBAAqB,CAAC;AAEhD,OAAO,cAAc,CAAC;AAEtB,OAAO,oCAAoC,CAAC;AAC5C,OAAO,+BAA+B,CAAC;AACvC,OAAO,2BAA2B,CAAC;AACnC,OAAO,4BAA4B,CAAC;AACpC,OAAO,2BAA2B,CAAC;AAEnC,OAAO,yBAAyB,CAAC;AAEjC,OAAO,EAAE,WAAW,EAAE,MAAM,gBAAgB,CAAC;AAI7C,OAAO,gCAAgC,CAAC;AACxC,OAAO,yCAAyC,CAAC;AACjD,OAAO,gDAAgD,CAAC;AAED,OAAO,EAE5D,sBAAsB,EACtB,gCAAgC,GACjC,MAAM,+CAA+C,CAAC;AACvD,OAAO,EAAE,QAAQ,EAAE,MAAM,yBAAyB,CAAC;AACnD,OAAO,EAAE,aAAa,EAAE,MAAM,yCAAyC,CAAC;AACxE,OAAO,EAAE,mBAAmB,EAAE,MAAM,6CAA6C,CAAC;AAElF,MAAM,UAAU,GAAG;IACjB,gBAAgB,EAAE,CAAC;IACnB,WAAW,EAAE,CAAC;IACd,QAAQ,EAAE,CAAC;IACX,SAAS,EAAE,CAAC;IACZ,gBAAgB,EAAE,CAAC;IACnB,WAAW,EAAE,CAAC;CACf,CAAC;AAUK,IAAM,iBAAiB,GAAvB,MAAM,iBAAkB,SAAQ,aAAa;IAsGlD;QACE,KAAK,EAAE,CAAC;QArGV,qBAAgB,GAAuB,SAAS,CAAC;QAejD,cAAS,GAAG,UAAU,CAAC,SAAS,CAAC;QAMjC,uBAAkB,GAAG,CAAC,CAAC;QAGvB,iBAAY,GAAG,KAAK,CAAC;QAMrB,mBAAc,GAAG,QAAQ,CAAC;QAe1B,8BAAyB,GAAG,uBAAuB,CAAC;QAGpD,eAAU,GAAG,SAAS,CAAC;QAGvB,sBAAiB,GAAG,SAAS,CAAC;QAG9B,wBAAmB,GAAG,SAAS,CAAC;QAGhC,uBAAkB,GAAG,SAAS,CAAC;QAG/B,sBAAiB,GAAG,SAAS,CAAC;QAG9B,gBAAW,GAAW,OAAO,CAAC;QAG9B,sBAAiB,GAAG,KAAK,CAAC;QAG1B,YAAO,GAAG,KAAK,CAAC;QAGhB,iBAAY,GAAG,KAAK,CAAC;QAYrB,iCAA4B,GAAG,CAAC,CAAC;QAGjC,oCAA+B,GAAG,CAAC,CAAC;QAGpC,mBAAc,GAAG,CAAC,CAAC;QAGnB,cAAS,GAAG,CAAC,CAAC;QAGd,cAAS,GAAG,CAAC,CAAC;QAsKd,WAAM,GAAa,IAAI,QAAQ,CAC7B,IAAI,EACJ;YACE;gBACE,IAAI,EAAE,GAAG;gBACT,MAAM,EAAE,GAAG,EAAE;oBACX,OAAO,IAAI,CAAA,qBAAqB,IAAI,CAAC,aAAa,cAAc,CAAC;gBACnE,CAAC;aACF;YACD,0BAA0B;YAC1B;gBACE,IAAI,EAAE,sBAAsB;gBAC5B,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,EACnC,IAAI,CACL,CAAC;oBACF,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,uBAAuB;gBAC7B,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,EACnC,IAAI,CACL,CAAC;oBAEF,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,uBAAuB;gBAC7B,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,EACnC,IAAI,CACL,CAAC;oBACF,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,wBAAwB;gBAC9B,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,EACnC,IAAI,CACL,CAAC;oBAEF,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,eAAe;gBACrB,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,OAAO,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;gBAC3C,CAAC;aACF;YACD;gBACE,IAAI,EAAE,cAAc;gBACpB,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,OAAO,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;gBAC3C,CAAC;aACF;YACD;gBACE,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC;gBAC9B,CAAC;aACF;YACD;gBACE,IAAI,EAAE,OAAO;gBACb,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC;gBAC9B,CAAC;aACF;YACD;gBACE,IAAI,EAAE,sBAAsB;gBAC5B,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,EACnC,IAAI,CACL,CAAC;oBACF,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,uBAAuB;gBAC7B,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,EACnC,IAAI,CACL,CAAC;oBAEF,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,oCAAoC;gBAC1C,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,EACnC,IAAI,CACL,CAAC;oBACF,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD,8DAA8D;YAC9D;gBACE,IAAI,EAAE,0EAA0E;gBAChF,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,CACpC,CAAC;oBACF,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;oBACnC,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,2EAA2E;gBACjF,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,CACpC,CAAC;oBACF,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;oBACnC,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,2EAA2E;gBACjF,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,CACpC,CAAC;oBACF,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;oBACnC,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,4EAA4E;gBAClF,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,CACpC,CAAC;oBACF,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;oBACnC,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,wEAAwE;gBAC9E,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,CACpC,CAAC;oBACF,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;oBACnC,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,yEAAyE;gBAC/E,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,CACpC,CAAC;oBACF,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;oBACnC,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBACnC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,yBAAyB;gBAC/B,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,CACpC,CAAC;oBAEF,OAAO,IAAI,CAAC,qBAAqB,EAAE,CAAC;gBACtC,CAAC;aACF;YACD;gBACE,IAAI,EAAE,0BAA0B;gBAChC,MAAM,EAAE,MAAM,CAAC,EAAE;oBACf,IAAI,CAAC,4BAA4B,CAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,CACpC,CAAC;oBAEF,OAAO,IAAI,CAAC,qBAAqB,EAAE,CAAC;gBACtC,CAAC;aACF;SACF,EACD;YACE,QAAQ,EAAE;gBACR,MAAM,EAAE,GAAG,EAAE,CAAC,IAAI,CAAA,yBAAyB;aAC5C;SACF,CACF,CAAC;QA6rBF,kBAAa,GAAG;YACd,iBAAiB,EAAE,WAAW,CAAC,sBAAsB;YACrD,cAAc,EAAE,WAAW,CAAC,mBAAmB;YAC/C,gBAAgB,EAAE,WAAW,CAAC,qBAAqB;YACnD,wBAAwB,EAAE,WAAW,CAAC,6BAA6B;YACnE,mBAAmB,EAAE,WAAW,CAAC,wBAAwB;YACzD,oBAAoB,EAAE,WAAW,CAAC,yBAAyB;YAC3D,2BAA2B,EAAE,WAAW,CAAC,yBAAyB;YAClE,sBAAsB,EAAE,WAAW,CAAC,yBAAyB;YAC7D,iBAAiB,EAAE,WAAW,CAAC,0BAA0B;YACzD,YAAY,EAAE,WAAW,CAAC,iBAAiB;YAC3C,oBAAoB,EAAE,WAAW,CAAC,yBAAyB;YAC3D,iBAAiB,EAAE,WAAW,CAAC,wBAAwB;YACvD,eAAe,EAAE,WAAW,CAAC,wBAAwB;YACrD,YAAY,EAAE,WAAW,CAAC,qBAAqB;YAC/C,aAAa,EAAE,WAAW,CAAC,sBAAsB;YACjD,YAAY,EAAE,WAAW,CAAC,qBAAqB;YAC/C,oBAAoB,EAAE,WAAW,CAAC,kBAAkB;YACpD,aAAa,EAAE,WAAW,CAAC,kBAAkB;YAC7C,cAAc,EAAE,WAAW,CAAC,eAAe;YAC3C,cAAc,EAAE,WAAW,CAAC,mBAAmB;YAC/C,sBAAsB,EAAE,WAAW,CAAC,oBAAoB;YACxD,sBAAsB,EAAE,WAAW,CAAC,oBAAoB;YACxD,yBAAyB,EAAE,WAAW,CAAC,uBAAuB;YAC9D,oBAAoB,EAAE,WAAW,CAAC,sBAAsB;YACxD,SAAS,EAAE,WAAW,CAAC,wBAAwB,EAAE,8BAA8B;YAC/E,WAAW,EAAE,WAAW,CAAC,oBAAoB;YAC7C,mBAAmB,EAAE,WAAW,CAAC,oBAAoB;YACrD,qBAAqB,EAAE,WAAW,CAAC,uBAAuB;YAC1D,uBAAuB,EAAE,WAAW,CAAC,yBAAyB;YAC9D,iBAAiB,EAAE,WAAW,CAAC,sBAAsB;YACrD,iBAAiB,EAAE,WAAW,CAAC,sBAAsB;YACrD,eAAe,EAAE,WAAW,CAAC,oBAAoB;YACjD,iBAAiB,EAAE,WAAW,CAAC,sBAAsB;YACrD,6BAA6B,EAAE,WAAW,CAAC,wBAAwB;YACnE,eAAe,EAAE,WAAW,CAAC,oBAAoB;YACjD,qBAAqB,EAAE,WAAW,CAAC,oBAAoB;YACvD,mBAAmB,EAAE,WAAW,CAAC,oBAAoB;YACrD,2BAA2B,EAAE,WAAW,CAAC,wBAAwB;YACjE,cAAc,EAAE,WAAW,CAAC,mBAAmB;YAC/C,KAAK,EAAE,WAAW,CAAC,sBAAsB,EAAE,8BAA8B;YACzE,IAAI,EAAE,WAAW,CAAC,sBAAsB,EAAE,8BAA8B;YACxE,IAAI,EAAE,WAAW,CAAC,sBAAsB,EAAE,8BAA8B;SACzE,CAAC;QAzkCA,MAAM,CAAC,WAAW,GAAG,IAAI,WAAW,EAAE,CAAC;QACvC,MAAM,CAAC,YAAY,GAAG,IAAI,YAAY,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QAC3D,MAAM,CAAC,OAAO,GAAG,IAAI,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QAEnD,gEAAgE;QAChE,MAAM,aAAa,GAAG,YAAY,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QAC/D,IAAI,aAAa,EAAE,CAAC;YAClB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAC5B,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;QAC7B,CAAC;QAED,MAAM,qBAAqB,GAAG,YAAY,CAAC,OAAO,CAChD,2BAA2B,CAC5B,CAAC;QACF,IAAI,qBAAqB,EAAE,CAAC;YAC1B,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;QAChC,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;QACjC,CAAC;QAED,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAEzC,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;IAED,gBAAgB;QACd,IAAI,WAAW,GAAG,KAAK,CAAC;QACxB,IAAI,cAAgD,CAAC;QAErD,MAAM,cAAc,GAAG,GAAG,EAAE;YAC1B,IAAI,CAAC,WAAW,EAAE,CAAC;gBACjB,WAAW,GAAG,IAAI,CAAC;gBACnB,cAAc,GAAG,WAAW,CAAC,GAAG,EAAE;oBAChC,MAAM,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,2BAA2B;gBACpD,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,yBAAyB;YAClC,CAAC;QACH,CAAC,CAAC;QAEF,MAAM,aAAa,GAAG,GAAG,EAAE;YACzB,IAAI,WAAW,EAAE,CAAC;gBAChB,aAAa,CAAC,cAAc,CAAC,CAAC;gBAC9B,WAAW,GAAG,KAAK,CAAC;YACtB,CAAC;QACH,CAAC,CAAC;QAEF,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,EAAE;YAC3C,IAAI,KAAK,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;gBACtC,cAAc,EAAE,CAAC;YACnB,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC,KAAK,EAAE,EAAE;YACzC,IAAI,KAAK,CAAC,GAAG,KAAK,GAAG,EAAE,CAAC;gBACtB,aAAa,EAAE,CAAC;YAClB,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAGD,kBAAkB;QAChB,OAAO,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAA;;UAEhC,IAAI,CAAC,aAAa;YAClB,CAAC,CAAC,IAAI,CAAA;gBACA,IAAI,CAAC,mBAAmB,EAAE;;;;;iCAKT,IAAI,CAAC,aAAa;gDACH,IAAI,CAAC,qBAAqB;gDAC1B,IAAI,CAAC,qBAAqB;8CAC5B,IAAI,CAAC,mBAAmB;uCAC/B,IAAI,CAAC,2BAA2B;iCACtC,IAAI,CAAC,MAAM;;;;;aAK/B;YACH,CAAC,CAAC,OAAO;;KAEd,CAAC,CAAC;IACL,CAAC;IAED,kBAAkB;QAChB,OAAO,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAA;;UAEhC,IAAI,CAAC,aAAa;YAClB,CAAC,CAAC,IAAI,CAAA;gBACA,IAAI,CAAC,mBAAmB,EAAE;;;;;iCAKT,IAAI,CAAC,aAAa;gDACH,IAAI,CAAC,qBAAqB;gDAC1B,IAAI,CAAC,qBAAqB;4CAC9B,IAAI,CAAC,iBAAiB;uCAC3B,IAAI,CAAC,yBAAyB;iCACpC,IAAI,CAAC,MAAM;;;;;aAK/B;YACH,CAAC,CAAC,OAAO;;KAEd,CAAC,CAAC;IACL,CAAC;IAED,4BAA4B,CAAC,YAAoB,EAAE,QAAQ,GAAG,KAAK;QACjE,IAAI,YAAY,KAAK,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAC3C,IAAI,CAAC,gBAAgB,GAAG,YAAY,CAAC;YACrC,IAAI,CAAC,IAAI,EAAE,CAAC;QACd,CAAC;QAED,IAAI,QAAQ,EAAE,CAAC;YACb,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;YAClC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;YAClC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;YAChC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;QAChC,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;YACf,UAAU,CAAC,GAAG,EAAE;gBACd,IAAI,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC;oBACzD,IAAI,IAAI,CAAC,EAAE,CAAC,SAAS,CAAkB,EAAE,CAAC;wBACvC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAmB,CAAC,WAAW,GAAG,CAAC,CAAC;oBACxD,CAAC;gBACH,CAAC;qBAAM,IAAI,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC;oBAC9D,IAAI,IAAI,CAAC,EAAE,CAAC,SAAS,CAAkB,EAAE,CAAC;wBACvC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAmB,CAAC,WAAW,GAAG,CAAC,CAAC;oBACxD,CAAC;gBACH,CAAC;qBAAM,IAAI,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC;oBAC7D,IAAI,IAAI,CAAC,EAAE,CAAC,SAAS,CAAkB,EAAE,CAAC;wBACvC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAmB,CAAC,WAAW,GAAG,CAAC,CAAC;oBACxD,CAAC;gBACH,CAAC;YACH,CAAC,EAAE,GAAG,CAAC,CAAC;QACV,CAAC;IACH,CAAC;IAED,qBAAqB,CAAC,MAAW;QAC/B,IAAI,CAAC,qBAAqB,GAAG,MAAM,CAAC,eAAe;YACjD,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,EAAE,EAAE,CAAC;YACtC,CAAC,CAAC,IAAI,CAAC;QACT,IAAI,CAAC,qBAAqB,GAAG,MAAM,CAAC,eAAe;YACjD,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,EAAE,EAAE,CAAC;YACtC,CAAC,CAAC,IAAI,CAAC;QACT,IAAI,CAAC,mBAAmB,GAAG,MAAM,CAAC,aAAa;YAC7C,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE,CAAC;YACpC,CAAC,CAAC,IAAI,CAAC;QACT,IAAI,CAAC,iBAAiB,GAAG,MAAM,CAAC,WAAW;YACzC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC;YAClC,CAAC,CAAC,IAAI,CAAC;IACX,CAAC;IAsMD,aAAa,CAAC,SAA6B,SAAS;QAClD,OAAO,IAAI,CAAA;;0BAEW,MAAM;0BACN,IAAI,CAAC,aAAa;YAChC,MAAM;;KAEb,CAAC;IACJ,CAAC;IAED,qBAAqB;QACnB,OAAO,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAA;;UAEhC,IAAI,CAAC,aAAa;YAClB,CAAC,CAAC,IAAI,CAAA;gBACA,IAAI,CAAC,mBAAmB,EAAE;;;;;iCAKT,IAAI,CAAC,aAAa;iCAClB,IAAI,CAAC,MAAM;;;;;aAK/B;YACH,CAAC,CAAC,OAAO;;KAEd,CAAC,CAAC;IACL,CAAC;IAED,yBAAyB,CAAC,SAAiB;QACzC,IAAI,SAAS,IAAI,CAAC,EAAE,CAAC;YACnB,OAAO,+BAA+B,CAAC;QACzC,CAAC;aAAM,IAAI,SAAS,IAAI,CAAC,EAAE,CAAC;YAC1B,OAAO,sBAAsB,CAAC;QAChC,CAAC;aAAM,CAAC;YACN,OAAO,uBAAuB,CAAC;QACjC,CAAC;IACH,CAAC;IAED,iBAAiB;QACf,KAAK,CAAC,iBAAiB,EAAE,CAAC;QAC1B,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAE5B,MAAM,UAAU,GAAG,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;QACxE,IAAI,UAAU,EAAE,CAAC;YACf,IAAI,CAAC,UAAU,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;QAChD,CAAC;QAED,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IAED,gBAAgB;QACd,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;QAC7B,IAAI,CAAC,EAAE,CAAC,eAAe,CAAe,CAAC,KAAK,GAAG,EAAE,CAAC;QAClD,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAAY,CAAC,IAAI,GAAG,IAAI,CAAC;IACzD,CAAC;IAED,KAAK,CAAC,IAAI;QACR,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,oBAAoB,CAAC,CAAC;QACnD,MAAM,iBAAiB,GAAG,CAAC,MAAM,MAAM,CAAC,WAAW,CAAC,UAAU,CAC5D,IAAI,CAAC,gBAAgB,EACrB,IAAI,CAAC,YAAY,EACjB,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,SAAS,CACpE,CAA4C,CAAC;QAE9C,IAAI,iBAAiB,IAAI,UAAU,IAAI,iBAAiB,EAAE,CAAC;YACzD,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;gBACtB,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,UAAU,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC;YAC1D,CAAC;YACD,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;YACjD,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC1B,CAAC;aAAM,CAAC;YACN,MAAM,YAAY,GAAG,iBAAoC,CAAC;YAE1D,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC,aAAa,CAAC;YAEhD,IAAI,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;gBAChD,IAAI,CAAC,4BAA4B;oBAC/B,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC;YACnE,CAAC;YAED,IAAI,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;gBAC/C,IAAI,CAAC,+BAA+B;oBAClC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC;YAClE,CAAC;YAED,QAAQ,CAAC,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC;YAEnC,IAAI,YAAY,CAAC,OAAO,KAAK,IAAI,EAAE,CAAC;gBAClC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YACtB,CAAC;iBAAM,CAAC;gBACN,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;YACvB,CAAC;YAED,IAAI,CAAC,UAAU,GAAG,YAAY,CAAC,aAAa,CAAC,WAAW;gBACtD,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,WAAW;gBACxC,CAAC,CAAC,SAAS,CAAC;YACd,IAAI,CAAC,iBAAiB,GAAG,YAAY,CAAC,aAAa,CAAC,mBAAmB,CAAC;YACxE,IAAI,CAAC,mBAAmB;gBACtB,YAAY,CAAC,aAAa,CAAC,qBAAqB,CAAC;YACnD,IAAI,CAAC,kBAAkB,GAAG,YAAY,CAAC,aAAa,CAAC,oBAAoB,CAAC;YAC1E,IAAI,CAAC,iBAAiB,GAAG,YAAY,CAAC,aAAa,CAAC,mBAAmB,CAAC;YACxE,IAAI,CAAC,WAAW,GAAG,YAAY,CAAC,aAAa,CAAC,YAAY;gBACxD,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,YAAY,CAAC,WAAW,EAAE;gBACvD,CAAC,CAAC,OAAO,CAAC;YAEZ,IAAI,CAAC,YAAY,EAAE,CAAC;YAEpB,KAAK,IAAI,UAAU,IAAI,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,CAAC;gBACtD,IAAI,UAAU,CAAC,SAAS,IAAI,UAAU,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;oBAC7D,KAAK,IAAI,UAAU,IAAI,UAAU,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;wBACxD,IAAI,CAAC,cAAc,IAAI,UAAU,CAAC,MAAM,CAAC;wBAEzC,KAAK,IAAI,QAAQ,IAAI,UAAU,EAAE,CAAC;4BAChC,IAAI,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC;gCACjC,IAAI,CAAC,SAAS,IAAI,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC;4BACzC,CAAC;4BACD,IAAI,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC;gCACjC,IAAI,CAAC,SAAS,IAAI,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC;4BACzC,CAAC;wBACH,CAAC;oBACH,CAAC;gBACH,CAAC;YACH,CAAC;YAED,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;QACnD,CAAC;IACH,CAAC;IAED,oBAAoB;QAClB,KAAK,CAAC,oBAAoB,EAAE,CAAC;QAC7B,IAAI,CAAC,qBAAqB,EAAE,CAAC;IAC/B,CAAC;IAED,WAAW,CAAC,KAAa;QACvB,IAAI,KAAK,EAAE,CAAC;YACV,6BAA6B;YAC7B,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YAChC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBACvB,OAAO,IAAI,KAAK,EAAE,CAAC;YACrB,CAAC;iBAAM,CAAC;gBACN,OAAO,SAAS,CAAC;YACnB,CAAC;QACH,CAAC;aAAM,CAAC;YACN,OAAO,SAAS,CAAC;QACnB,CAAC;IACH,CAAC;IAED,YAAY,CAAC,SAAkC,SAAS;QACtD,IAAI,QAAQ,GAAG,EAAS,CAAC;QAEzB,yCAAyC;QACzC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,yBAAyB,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QAEtE,MAAM,MAAM,GACV,IAAI,CAAC,aAAa,KAAK,SAAS;YAC9B,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,8BAA8B,CAAC,CAAC,OAAO;YAC3D,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC;QAEzB,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC;YACvB,MAAM,KAAK,GAAG,oBAAoB,CAChC,WAAW,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,iBAAiB,IAAI,SAAS,CAAC,EACnE;gBACE;oBACE,IAAI,EAAE,SAAS;oBACf,KAAK,EAAE,WAAW,CAAC,MAAM,CAAC;oBAC1B,KAAK,EAAE,IAAI;iBACZ;gBACD;oBACE,IAAI,EAAE,WAAW;oBACjB,KAAK,EAAE,WAAW,CAAC,MAAM,CAAC;oBAC1B,KAAK,EAAE,IAAI;iBACZ;aACF,CACF,CAAC;YAEF,UAAU,CAAC,KAAK,EAAE,EAAE,MAAM,EAAE,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;QAC7D,CAAC;aAAM,CAAC;YACN,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC;gBACtC,QAAQ,GAAG,gCAAgC,CACzC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,EACjC,MAAM,EACN,IAAI,CAAC,WAAW,EAChB,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CACnC,CAAC;YACJ,CAAC;iBAAM,CAAC;gBACN,QAAQ,GAAG,gCAAgC,CACzC;oBACE,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,iBAAiB,IAAI,SAAS,CAAC;oBAC9D,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,mBAAmB,IAAI,SAAS,CAAC;oBAClE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,kBAAkB,IAAI,SAAS,CAAC;oBAChE,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,iBAAiB,IAAI,SAAS,CAAC;iBAC/D,EACD,MAAM,EACN,SAAS,EACT,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CACnC,CAAC;YACJ,CAAC;YAED,sBAAsB,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAC7C,CAAC;IACH,CAAC;IAED,cAAc;QACZ,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;IACpC,CAAC;IAED,UAAU,CAAC,KAAkB;QAC3B,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,IAAI,CAAC,EAAE,CAAC;YAClC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACrB,CAAC;aAAM,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,IAAI,CAAC,EAAE,CAAC;YACzC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACrB,CAAC;aAAM,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,IAAI,CAAC,EAAE,CAAC;YACzC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACrB,CAAC;aAAM,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,IAAI,CAAC,EAAE,CAAC;YACzC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACrB,CAAC;IACH,CAAC;IAED,gBAAgB,CAAC,KAAkB;QACjC,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,IAAI,CAAC,EAAE,CAAC;YACjC,KAAK,CAAC,MAAwB,CAAC,WAAW,GAAG,CAAC,CAAC;QAClD,CAAC;QACD;;;;;;;;;;;WAWG;IACL,CAAC;IAED,aAAa;QACX,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,GAAG,CAAC;IAC7B,CAAC;IAED,KAAK,CAAC,gBAAgB,CAAC,KAAkB;QACvC,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC,MAAM,CAAC;QACrC,MAAM,IAAI,CAAC,cAAc,CAAC;QACzB,IAAI,CAAC,EAAE,CAAC,WAAW,CAAc,CAAC,IAAI,EAAE,CAAC;IAC5C,CAAC;IAED,oBAAoB;QAClB,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;QAC9C,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAC5D,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACrE,IAAI,CAAC,WAAW,CACd,2BAA2B,EAC3B,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,CACvC,CAAC;QAEF,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE,GAAG,EAAE;YACvC,wDAAwD;YACxD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;YAC3C,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,qBAAqB;QACnB,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAC/D,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;QACjD,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACxE,IAAI,CAAC,cAAc,CACjB,2BAA2B,EAC3B,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,CACvC,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,2BAA2B,CAAC,KAAkB;QAClD,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC,MAAM,CAAC,qBAAqB,CAAC;QAChE,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC,MAAM,CAAC,qBAAqB,CAAC;QAChE,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC,MAAM,CAAC,mBAAmB,CAAC;QAC5D,MAAM,IAAI,CAAC,qBAAqB,EAAE,CAAC;QACnC;;WAEG;IACL,CAAC;IAED,KAAK,CAAC,yBAAyB,CAAC,KAAkB;QAChD,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC,MAAM,CAAC,qBAAqB,CAAC;QAChE,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC,MAAM,CAAC,qBAAqB,CAAC;QAChE,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC,MAAM,CAAC,iBAAiB,CAAC;QACxD,MAAM,IAAI,CAAC,oBAAoB,EAAE,CAAC;IACpC,CAAC;IAED,KAAK,CAAC,oBAAoB;QACxB,IAAI,IAAY,CAAC;QACjB,IACE,IAAI,CAAC,iBAAiB,KAAK,IAAI;YAC/B,IAAI,CAAC,qBAAqB,KAAK,IAAI;YACnC,IAAI,CAAC,qBAAqB,KAAK,IAAI,EACnC,CAAC;YACD,IAAI,GAAG,aAAa,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACpI,CAAC;aAAM,IACL,IAAI,CAAC,qBAAqB,KAAK,IAAI;YACnC,IAAI,CAAC,qBAAqB,KAAK,IAAI,EACnC,CAAC;YACD,IAAI,GAAG,aAAa,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC1G,CAAC;aAAM,IACL,IAAI,CAAC,qBAAqB,KAAK,IAAI;YACnC,IAAI,CAAC,qBAAqB,KAAK,SAAS,EACxC,CAAC;YACD,IAAI,GAAG,aAAa,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC5E,CAAC;aAAM,CAAC;YACN,IAAI,GAAG,aAAa,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC9C,CAAC;QAED,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAE7B,UAAU,CAAC,GAAG,EAAE;YACd,IAAI,MAAM,CAAC,QAAQ,CAAC,QAAQ,IAAI,IAAI,EAAE,CAAC;gBACrC,OAAO,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;gBAChC,qCAAqC;YACvC,CAAC;YACD,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,KAAK,CAAC,qBAAqB;QACzB,IAAI,IAAY,CAAC;QACjB,IACE,IAAI,CAAC,iBAAiB,KAAK,IAAI;YAC/B,IAAI,CAAC,qBAAqB,KAAK,IAAI;YACnC,IAAI,CAAC,qBAAqB,KAAK,IAAI,EACnC,CAAC;YACD,IAAI,GAAG,aAAa,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACpI,CAAC;aAAM,IACL,IAAI,CAAC,mBAAmB,KAAK,IAAI;YACjC,IAAI,CAAC,qBAAqB,KAAK,IAAI;YACnC,IAAI,CAAC,qBAAqB,KAAK,IAAI,EACnC,CAAC;YACD,IAAI,GAAG,cAAc,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,mBAAmB,EAAE,CAAC;QACvI,CAAC;aAAM,IACL,IAAI,CAAC,qBAAqB,KAAK,IAAI;YACnC,IAAI,CAAC,qBAAqB,KAAK,IAAI,EACnC,CAAC;YACD,IAAI,GAAG,cAAc,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC3G,CAAC;aAAM,IACL,IAAI,CAAC,qBAAqB,KAAK,IAAI;YACnC,IAAI,CAAC,qBAAqB,KAAK,SAAS,EACxC,CAAC;YACD,IAAI,GAAG,cAAc,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC7E,CAAC;aAAM,CAAC;YACN,IAAI,GAAG,cAAc,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC/C,CAAC;QAED,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAE7B,UAAU,CAAC,GAAG,EAAE;YACd,IAAI,MAAM,CAAC,QAAQ,CAAC,QAAQ,IAAI,IAAI,EAAE,CAAC;gBACrC,OAAO,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;gBAChC,qCAAqC;YACvC,CAAC;YACD,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,OAAO,CAAC,iBAAyD;QAC/D,KAAK,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;QACjC,IACE,iBAAiB,CAAC,GAAG,CAAC,YAAY,CAAC;YACnC,iBAAiB,CAAC,GAAG,CAAC,eAAe,CAAC,EACtC,CAAC;YACD,IAAI,CAAC,YAAY,EAAE,CAAC;QACtB,CAAC;IACH,CAAC;IAED,SAAS,CAAC,KAAkB;QAC1B,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QACpC,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC;QACzC,kDAAkD;IACpD,CAAC;IAED,IAAI,cAAc;QAChB,OAAO,IAAI,CAAC;IACd,CAAC;IAED,qBAAqB,CAAC,KAAkB;QACtC,IAAI,CAAC,UAAU,CAAC,gBAAgB,EAAE,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IACxD,CAAC;IAED,MAAM,KAAK,MAAM;QACf,OAAO;YACL,OAAO;YACP,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAqMF;SACF,CAAC;IACJ,CAAC;IAED,WAAW,CAAC,KAAa;QACvB,IAAI,CAAC,UAAU,CAAC,EAAE,MAAM,EAAE,EAAE,WAAW,EAAE,KAAK,EAAE,EAAiB,CAAC,CAAC;IACrE,CAAC;IAED,gBAAgB,CAAC,KAAkB;QACjC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC,MAAM,CAAC;IACjC,CAAC;IAED,iBAAiB;QACf,IAAI,IAAI,CAAC,kBAAkB,GAAG,EAAE,KAAK,CAAC,EAAE,CAAC;YACvC,MAAM,CAAC,YAAY,CAAC,QAAQ,CAC1B,cAAc,IAAI,CAAC,kBAAkB,QAAQ,CAC9C,CAAC;QACJ,CAAC;IACH,CAAC;IAED,kBAAkB;QAChB,OAAO,IAAI,CAAA,qDAAqD,CAAC;IACnE,CAAC;IAED,WAAW;QACT,OAAO,IAAI,CAAA,qDAAqD,CAAC;IACnE,CAAC;IAED,cAAc;QACZ,IAAI,CAAC,aAAa,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC;QACzC,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC;YACvB,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,sBAAsB,CAAC,CAAC;YACrD,YAAY,CAAC,OAAO,CAAC,kBAAkB,EAAE,MAAM,CAAC,CAAC;QACnD,CAAC;aAAM,CAAC;YACN,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,uBAAuB,CAAC,CAAC;YACtD,YAAY,CAAC,UAAU,CAAC,kBAAkB,CAAC,CAAC;QAC9C,CAAC;QACD,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IAED,sBAAsB;QACpB,IAAI,CAAC,iBAAiB,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC;QACjD,IAAI,IAAI,CAAC,iBAAiB,EAAE,CAAC;YAC3B,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,+BAA+B,CAAC,CAAC;YAC9D,YAAY,CAAC,OAAO,CAAC,2BAA2B,EAAE,MAAM,CAAC,CAAC;QAC5D,CAAC;aAAM,CAAC;YACN,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,mCAAmC,CAAC,CAAC;YAClE,YAAY,CAAC,UAAU,CAAC,2BAA2B,CAAC,CAAC;QACvD,CAAC;QACD,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IAED,UAAU;QACR,gHAAgH;QAChH,MAAM,aAAa,GAAG,YAAY,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QAC/D,IAAI,aAAa,EAAE,CAAC;YAClB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAC5B,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;QAC7B,CAAC;QAED,MAAM,qBAAqB,GAAG,YAAY,CAAC,OAAO,CAChD,2BAA2B,CAC5B,CAAC;QAEF,IAAI,qBAAqB,EAAE,CAAC;YAC1B,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;QAChC,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;QACjC,CAAC;QAED,MAAM,eAAe,GAAG,YAAY,CAAC,OAAO,CAC1C,IAAI,CAAC,yBAAyB,CAC/B,CAAC;QACF,IAAI,eAAe,EAAE,CAAC;YACpB,IAAI,CAAC,UAAU,GAAG,eAAe,CAAC;QACpC,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;QAEpD,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IAED,WAAW;QACT,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACnB,IAAI,IAAI,CAAC,EAAE,CAAC,SAAS,CAAkB,EAAE,CAAC;YACvC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAmB,CAAC,WAAW,GAAG,CAAC,CAAC;QACxD,CAAC;IACH,CAAC;IAED,WAAW;QACT,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACnB,IAAI,IAAI,CAAC,EAAE,CAAC,SAAS,CAAkB,EAAE,CAAC;YACvC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAmB,CAAC,WAAW,GAAG,CAAC,CAAC;QACxD,CAAC;IACH,CAAC;IAED,aAAa;QACX,sCAAsC;IACxC,CAAC;IAED,SAAS;QACP,kCAAkC;IACpC,CAAC;IAED,UAAU;QACR,uBAAuB;QACvB,MAAM,CAAC,IAAI,CAAC,oDAAoD,EAAE,QAAQ,CAAC,CAAC;IAC9E,CAAC;IA+CD,WAAW,CAAC,GAAW;QACrB,OAAO,GAAG,CAAC,OAAO,CAAC,WAAW,EAAE,UAAU,CAAC;YACzC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;QAC5B,CAAC,CAAC,CAAC;IACL,CAAC;IAED,WAAW;QACT,OAAO,IAAI,CAAA;;;YAGH,IAAI,CAAC,CAAC,CAAC,iBAAiB,CAAC;YACzB,mBAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC;;;YAG/C,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,KAAK,mBAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;;;YAGnE,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,KAAK,mBAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;;;YAGnE,IAAI,CAAC,CAAC,CAAC,uBAAuB,CAAC;YAC/B,mBAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,4BAA4B,CAAC;;;YAG7D,IAAI,CAAC,CAAC,CAAC,sBAAsB,CAAC;YAC9B,mBAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,+BAA+B,CAAC;;;KAGvE,CAAC;IACJ,CAAC;IAED,WAAW;QACT,uBAAuB;QACvB,IAAI,SAAS,GAAG,CAAC,CAAC;QAClB,IAAI,QAAQ,GAAG,CAAC,CAAC;QACjB,IAAI,SAAS,GAAG,CAAC,CAAC;QAClB,IAAI,aAAa,GAAG,CAAC,CAAC;QAEtB,IAAI,CAAC;YACH,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBACrD,YAAY;gBACZ,MAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBACnD,IAAI,SAAS,EAAE,CAAC;oBACd,IAAI,SAAS,CAAC,YAAY,IAAI,SAAS,CAAC,aAAa,EAAE,CAAC;wBACtD,MAAM,SAAS,GAAG,SAAS,CAAC,YAAY,GAAG,SAAS,CAAC,aAAa,CAAC;wBACnE,SAAS,IAAI,SAAS,CAAC;wBACvB,iCAAiC;wBACjC,MAAM,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;wBAC/C,oEAAoE;wBAEpE,YAAY;wBACZ,MAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;wBAC1D,IAAI,CAAC,cAAc,EAAE,CAAC;4BACpB,OAAO,CAAC,KAAK,CAAC,qBAAqB,KAAK,EAAE,CAAC,CAAC;wBAC9C,CAAC;6BAAM,CAAC;4BACN,IACE,cAAc,CAAC,IAAI,KAAK,OAAO;gCAC/B,cAAc,CAAC,IAAI,KAAK,oBAAoB,EAC5C,CAAC;gCACD,QAAQ,IAAI,SAAS,CAAC;4BACxB,CAAC;iCAAM,IACL,cAAc,CAAC,IAAI,KAAK,eAAe;gCACvC,cAAc,CAAC,IAAI,KAAK,oBAAoB,EAC5C,CAAC;gCACD,SAAS,IAAI,SAAS,CAAC;4BACzB,CAAC;iCAAM,IAAI,cAAc,CAAC,IAAI,KAAK,mBAAmB,EAAE,CAAC;gCACvD,aAAa,IAAI,SAAS,CAAC;4BAC7B,CAAC;iCAAM,CAAC;gCACN,OAAO,CAAC,KAAK,CAAC,uBAAuB,cAAc,CAAC,IAAI,EAAE,CAAC,CAAC;4BAC9D,CAAC;wBACH,CAAC;oBACH,CAAC;gBACH,CAAC;qBAAM,CAAC;oBACN,OAAO,CAAC,IAAI,CAAC,qBAAqB,KAAK,EAAE,CAAC,CAAC;gBAC7C,CAAC;YACH,CAAC,CAAC,CAAC;QACL,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC;QACtC,CAAC;QAED,+BAA+B;QAC/B,IAAI,aAAa,GAAG,EAAE,CAAC;QAEvB,8BAA8B;QAC9B,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YACtB,aAAa,CAAC,IAAI,CAChB,IAAI,CAAA;yBACa,mBAAmB,CAAC,MAAM,CAAC,SAAS,CAAC;eAC/C,EACP,IAAI,CAAA;yBACa,mBAAmB,CAAC,MAAM,CAAC,QAAQ,CAAC;eAC9C,CACR,CAAC;YACF,aAAa,CAAC,IAAI,CAChB,IAAI,CAAA;2BACe,mBAAmB,CAAC,MAAM,CAAC,SAAS,CAAC;eACjD,CACR,CAAC;YACF,aAAa,CAAC,IAAI,CAChB,IAAI,CAAA;+BACmB,mBAAmB,CAAC,MAAM,CAAC,aAAa,CAAC;eACzD,CACR,CAAC;YACF,MAAM,eAAe,GAAmC,EAAE,CAAC;YAC3D,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBACrD,YAAY;gBACZ,MAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBACnD,MAAM,SAAS,GAAG,SAAS,CAAC,YAAY,GAAG,SAAS,CAAC,aAAa,CAAC;gBACnE,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC;oBACtB,eAAe,CAAC,IAAI,CAAC;wBACnB,KAAK;wBACL,IAAI,EAAE,SAAS;qBAChB,CAAC,CAAC;gBACL,CAAC;YACH,CAAC,CAAC,CAAC;YAEH,uCAAuC;YACvC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;YAEhD,yCAAyC;YACzC,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;gBAC7B,aAAa,CAAC,IAAI,CAChB,IAAI,CAAA;eACC,mBAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC;cACtC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC;iBACzB,CACR,CAAC;YACJ,CAAC,CAAC,CAAC;QACL,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;YACvB,aAAa,CAAC,IAAI,CAChB,IAAI,CAAA;+BACmB,IAAI,CAAC,cAAc;eACnC,CACR,CAAC;QACJ,CAAC;QAED,OAAO,IAAI,CAAA,gCAAgC,aAAa,QAAQ,CAAC;IACnE,CAAC;IAED,qBAAqB,CAAC,OAAuB;QAC3C,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC;YACvB,OAAO,OAAO,CAAC;QACjB,CAAC;aAAM,CAAC;YACN,OAAO,IAAI,CAAA;;;;OAIV,CAAC;QACJ,CAAC;IACH,CAAC;IAED,cAAc,CAAC,KAAkB;QAC/B,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;IAC3B,CAAC;IAED,gBAAgB,CAAC,OAAe;QAC9B,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;QAExB,MAAM,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE;YACjD,GAAG,EAAE,SAAS;YACd,KAAK,EAAE,MAAM;YACb,IAAI,EAAE,SAAS;SAChB,CAAC,CAAC;QAEH,OAAO,YAAY,aAAa,MAAM,CAAC;IACzC,CAAC;IAED,iBAAiB,CAAC,QAAQ,GAAE,KAAK;QAC/B,OAAO,IAAI,CAAA;UACL,CAAC,IAAI,CAAC,aAAa;YACnB,CAAC,CAAC,IAAI,CAAA;;;0BAGU,IAAI,CAAC,cAAc;;;aAGhC;YACH,CAAC,CAAC,IAAI,CAAA;;;0BAGU,IAAI,CAAC,cAAc;;;aAGhC;wBACW,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC;;;;;mBAKtC,IAAI,CAAC,aAAa;;UAE3B,CAAC,IAAI,CAAC,iBAAiB;YACvB,CAAC,CAAC,IAAI,CAAA;;;wBAGQ,IAAI,CAAC,sBAAsB;;;kBAGjC;YACR,CAAC,CAAC,IAAI,CAAA;;;0BAGU,IAAI,CAAC,sBAAsB;;;aAGxC;wBACW,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC;aAC1C,CAAC;IACZ,CAAC;IAED,UAAU;QACR,OAAO,IAAI,CAAA;;gCAEiB,IAAI,CAAC,CAAC,CAAC,cAAc,CAAC;;;;;;;KAOjD,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,aAAa;QACjB,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;QAChC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;QAClC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;QAClC,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC7B,MAAM,IAAI,CAAC,cAAc,CAAC;QACzB,IAAI,CAAC,EAAE,CAAC,cAAc,CAAiB,EAAE,KAAK,EAAE,CAAC;IACpD,CAAC;IAED,KAAK,CAAC,YAAY;QAChB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;QAC9B,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;QAChC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;QAClC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;QAClC,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC5B,MAAM,IAAI,CAAC,cAAc,CAAC;QACzB,IAAI,CAAC,EAAE,CAAC,aAAa,CAAgB,EAAE,KAAK,EAAE,CAAC;IAClD,CAAC;IAED,KAAK,CAAC,eAAe;QACnB,MAAM,IAAI,GAAG,gBAAgB,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACrD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACvB,UAAU,CAAC,GAAG,EAAE;YACd,IAAI,MAAM,CAAC,QAAQ,CAAC,QAAQ,IAAI,IAAI,EAAE,CAAC;gBACrC,OAAO,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;gBAChC,qCAAqC;YACvC,CAAC;YACD,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,mBAAmB;QACjB,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;YACd,OAAO,IAAI,CAAA;;;;gBAID,IAAI,CAAC,UAAU,EAAE;;;;;;;uBAQjB,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;gBAC1C,mBACF;;wBAEU,GAAG,EAAE,CAAC,IAAI,CAAC,eAAe,EAAE;0BAC1B,CAAC,CAAgB,EAAE,EAAE;gBAC/B,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,EAAE,CAAC;oBACtB,IAAI,CAAC,eAAe,EAAE,CAAC;gBACzB,CAAC;YACH,CAAC;;;qCAGsB,IAAI,CAAC,CAAC,CAAC,cAAc,CAAC;4CACf,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC;;;;;uBAM/C,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,IAAI,mBAC9C;;wBAEU,KAAK,IAAI,EAAE;gBACnB,IAAI,CAAC,aAAa,EAAE,CAAC;gBACrB,UAAU,CAAC,GAAG,EAAE;oBACd,IAAI,CAAC,aAAa,EAAE,CAAC;gBACvB,CAAC,CAAC,CAAC;YACL,CAAC;0BACW,CAAC,CAAgB,EAAE,EAAE;gBAC/B,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,EAAE,CAAC;oBACtB,IAAI,CAAC,aAAa,EAAE,CAAC;gBACvB,CAAC;YACH,CAAC;;qCAEsB,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC;4CAExC,IAAI,CAAC,4BACP;;;;;uBAME,IAAI,CAAC,SAAS,IAAI,UAAU,CAAC,gBAAgB;gBAC7C,mBACF;;qCAEuB,IAAI,CAAC,CAAC,CAAC,mBAAmB,CAAC;4CACpB,IAAI,CAAC,CAAC,CAAC,mBAAmB,CAAC;;;;;;uBAOvD,IAAI,CAAC,SAAS,IAAI,UAAU,CAAC,gBAAgB;gBAC7C,mBACF;;wBAEU,KAAK,IAAI,EAAE;gBACnB,IAAI,CAAC,YAAY,EAAE,CAAC;gBACpB,UAAU,CAAC,GAAG,EAAE;oBACd,IAAI,CAAC,aAAa,EAAE,CAAC;gBACvB,CAAC,CAAC,CAAC;YACL,CAAC;0BACW,CAAC,CAAgB,EAAE,EAAE;gBAC/B,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,EAAE,CAAC;oBACtB,IAAI,CAAC,YAAY,EAAE,CAAC;gBACtB,CAAC;YACH,CAAC;;qCAEsB,IAAI,CAAC,CAAC,CAAC,cAAc,CAAC;4CAE3C,IAAI,CAAC,+BACP;;;;;;;yBAOW,IAAI,CAAC,iBAAiB;0BACrB,CAAC,CAAgB,EAAE,EAAE;gBAC/B,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,EAAE,CAAC;oBACtB,IAAI,CAAC,aAAa,EAAE,CAAC;gBACvB,CAAC;YACH,CAAC;wBACS,IAAI,CAAC,aAAa;;qCAEL,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC;4CACZ,IAAI,CAAC,CAAC,CAAC,iBAAiB,CAAC;;;;;yBAK5C,IAAI,CAAC,iBAAiB;0BACrB,CAAC,CAAgB,EAAE,EAAE;gBAC/B,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,EAAE,CAAC;oBACtB,IAAI,CAAC,SAAS,EAAE,CAAC;gBACnB,CAAC;YACH,CAAC;wBACS,IAAI,CAAC,SAAS;;qCAED,IAAI,CAAC,CAAC,CAAC,gBAAgB,CAAC;4CACjB,IAAI,CAAC,CAAC,CAClC,wBAAwB,CACzB;;;;;;0BAMW,CAAC,CAAgB,EAAE,EAAE;gBAC/B,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,EAAE,CAAC;oBACtB,IAAI,CAAC,UAAU,EAAE,CAAC;gBACpB,CAAC;YACH,CAAC;wBACS,IAAI,CAAC,UAAU;;qCAEF,IAAI,CAAC,CAAC,CAAC,aAAa,CAAC;4CACd,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC;;;;gBAI9C,IAAI,CAAC,iBAAiB,EAAE;;;;cAI1B,IAAI,CAAC,WAAW,EAAE,IAAI,IAAI,CAAC,WAAW,EAAE;;;;;OAK/C,CAAC;QACJ,CAAC;aAAM,CAAC;YACN,OAAO,IAAI,CAAA;;;;;yCAKwB,IAAI,CAAC,gBAAgB;;;wBAGtC,IAAI,CAAC,eAAe;wBACpB,IAAI,CAAC,CAAC,CAAC,cAAc,CAAC;;;;;;;wBAOtB,IAAI,CAAC,aAAa;wBAClB,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC;;;;;;yCAMF,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC;;;;;wBAKnC,IAAI,CAAC,UAAU;wBACf,IAAI,CAAC,CAAC,CAAC,aAAa,CAAC;;;;;;;;OAQtC,CAAC;QACJ,CAAC;IACH,CAAC;IAED,kBAAkB;QAChB,IAAI,CAAC,YAAY,GAAI,IAAI,CAAC,EAAE,CAAC,eAAe,CAAe,CAAC,KAAK,CAAC;QACjE,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAAY,CAAC,IAAI,GAAG,KAAK,CAAC;QACxD,IAAI,CAAC,IAAI,EAAE,CAAC;IACd,CAAC;IAED,qBAAqB;QACnB,OAAO,IAAI,CAAA;;iBAEE,CAAC,CAAM,EAAE,EAAE;YACpB,CAAC,CAAC,cAAc,EAAE,CAAC;QACrB,CAAC;;;UAGG,IAAI,CAAC,CAAC,CAAC,uBAAuB,CAAC;;;;;;oBAMrB,CAAC,CAAgB,EAAE,EAAE;YAC7B,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,EAAE,CAAC;gBACtB,IAAI,CAAC,kBAAkB,EAAE,CAAC;YAC5B,CAAC;QACH,CAAC;;sCAE2B,IAAI,CAAC,kBAAkB;aAChD,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC;;;;kBAIX,CAAC;IACjB,CAAC;IAED,MAAM;QACJ,OAAO,IAAI,CAAA;MACT,IAAI,CAAC,qBAAqB,EAAE;MAC5B,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;;;QAIlB,IAAI,CAAC,gBAAgB;YACnB,CAAC,CAAC,IAAI,CAAA;;;uCAGuB,IAAI,CAAC,cAAc;;8BAE5B,IAAI,CAAC,gBAAgB;;aAEtC;YACH,CAAC,CAAC,OACN;OACC,CAAC;IACN,CAAC;CACF,CAAA;AAvqDC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;2DACsB;AAGjD;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;gEACe;AAG1C;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;gEACe;AAG1C;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;8DACa;AAGxC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;4DACW;AAGtC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;oDACM;AAGjC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;wDACiB;AAG5C;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;6DACJ;AAGvB;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;uDACP;AAGrB;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;2DACU;AAGrC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;yDACD;AAG1B;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;mDACT;AAGlB;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;uDACM;AAGjC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;mEACkB;AAG7C;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;uDACM;AAGjC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;oEACyB;AAGpD;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;qDACJ;AAGvB;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;4DACG;AAG9B;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;8DACK;AAGhC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;6DACI;AAG/B;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;4DACG;AAG9B;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;sDACG;AAG9B;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;4DACF;AAG1B;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;kDACZ;AAGhB;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;uDACP;AAGrB;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;2DACD;AAG1B;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;4DACD;AAG1B;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;6DACA;AAG3B;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;uEACM;AAGjC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;0EACS;AAGpC;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;yDACR;AAGnB;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;oDACb;AAGd;IADC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;oDACb;AAlGH,iBAAiB;IAD7B,aAAa,CAAC,QAAQ,CAAC;GACX,iBAAiB,CAyqD7B","sourcesContent":["import { html, css, nothing, TemplateResult } from 'lit';\nimport { property, customElement, query } from 'lit/decorators.js';\nimport 'urlpattern-polyfill';\n\nimport '@material/web/labs/navigationbar/navigation-bar.js';\nimport '@material/web/labs/navigationtab/navigation-tab.js';\n//import '@material/web/labs/navigationdrawer/lib/navigation-drawer-styles.css.js';\nimport '@material/web/labs/navigationdrawer/navigation-drawer.js';\nimport '@material/web/list/list-item.js';\nimport '@material/web/list/list.js';\nimport '@material/web/icon/icon.js';\nimport '@material/web/iconbutton/icon-button.js';\nimport '@material/web/iconbutton/outlined-icon-button.js';\nimport '@material/mwc-snackbar/mwc-snackbar.js';\n\nimport {\n  applyTheme,\n  argbFromHex,\n  themeFromSourceColor,\n} from '@material/material-color-utilities';\n\nimport '@material/web/menu/menu.js';\nimport { cache } from 'lit/directives/cache.js';\n\nimport '@yrpri/webapp/common/yp-image.js';\n\n//import './chat/yp-chat-assistant.js';\nimport { Layouts } from './flexbox-literals/classes.js';\n\nimport './policies/ps-web-research.js';\n\nimport { PsServerApi } from './base/PsServerApi.js';\nimport { PsAppGlobals } from './base/PsAppGlobals.js';\nimport { MdNavigationDrawer } from '@material/web/labs/navigationdrawer/navigation-drawer.js';\nimport { Snackbar } from '@material/mwc-snackbar/mwc-snackbar.js';\nimport { NavigationBar } from '@material/web/labs/navigationbar/internal/navigation-bar.js';\n\nimport { PsAppUser } from './base/PsAppUser.js';\n\nimport './ps-home.js';\n\nimport './policies/ps-problem-statement.js';\nimport './policies/ps-sub-problems.js';\nimport './policies/ps-entities.js';\nimport './policies/ps-solutions.js';\nimport './policies/ps-policies.js';\n\nimport './ltp/ltp-manage-crt.js';\n\nimport { PsConstants } from './constants.js';\nimport { PsSolutions } from './policies/ps-solutions.js';\nimport { TextField } from '@material/web/textfield/internal/text-field.js';\nimport { Dialog } from '@material/web/dialog/internal/dialog.js';\nimport '@material/web/dialog/dialog.js';\nimport '@material/web/button/elevated-button.js';\nimport '@material/web/textfield/outlined-text-field.js';\nimport { debug } from 'console';\nimport { PsPolicies } from './policies/ps-policies.js';import {\n  Scheme,\n  applyThemeWithContrast,\n  themeFromSourceColorWithContrast,\n} from '@yrpri/webapp/common/YpMaterialThemeHelper.js';\nimport { PsRouter } from './base/router/router.js';\nimport { YpBaseElement } from '@yrpri/webapp/common/yp-base-element.js';\nimport { YpFormattingHelpers } from '@yrpri/webapp/common/YpFormattingHelpers.js';\n\nconst PagesTypes = {\n  ProblemStatement: 1,\n  SubProblems: 2,\n  Entities: 3,\n  Solutions: 4,\n  PolicyCategories: 5,\n  PolicyIdeas: 6,\n};\n\ndeclare global {\n  interface Window {\n    psAppGlobals: PsAppGlobals;\n    psServerApi: PsServerApi;\n  }\n}\n\n@customElement('ps-app')\nexport class PolicySynthWebApp extends YpBaseElement {\n  @property({ type: Number })\n  currentProjectId: number | undefined = undefined;\n\n  @property({ type: Number })\n  activeSubProblemIndex: number | undefined;\n\n  @property({ type: Number })\n  activePopulationIndex: number | undefined;\n\n  @property({ type: Number })\n  activeSolutionIndex: number | undefined;\n\n  @property({ type: Number })\n  activePolicyIndex: number | undefined;\n\n  @property({ type: Number })\n  pageIndex = PagesTypes.Solutions;\n\n  @property({ type: Object })\n  currentMemory: PsSmarterCrowdsourcingMemoryData | undefined;\n\n  @property({ type: Number })\n  totalNumberOfVotes = 0;\n\n  @property({ type: Boolean })\n  showAllCosts = false;\n\n  @property({ type: String })\n  lastSnackbarText: string | undefined;\n\n  @property({ type: String })\n  collectionType = 'domain';\n\n  @property({ type: String })\n  earlName!: string;\n\n  @property({ type: String })\n  currentError: string | undefined;\n\n  @property({ type: String })\n  forceGetBackupForProject: string | undefined;\n\n  @property({ type: String })\n  tempPassword: string | undefined;\n\n  @property({ type: String })\n  localStorageThemeColorKey = 'md3-ps-theme-color-v2';\n\n  @property({ type: String })\n  themeColor = '#df2302';\n\n  @property({ type: String })\n  themePrimaryColor = '#000000';\n\n  @property({ type: String })\n  themeSecondaryColor = '#000000';\n\n  @property({ type: String })\n  themeTertiaryColor = '#000000';\n\n  @property({ type: String })\n  themeNeutralColor = '#000000';\n\n  @property({ type: String })\n  themeScheme: Scheme = 'tonal';\n\n  @property({ type: Boolean })\n  themeHighContrast = false;\n\n  @property({ type: Boolean })\n  isAdmin = false;\n\n  @property({ type: Boolean })\n  surveyClosed = false;\n\n  @property({ type: String })\n  appearanceLookup!: string;\n\n  @property({ type: String })\n  currentLeftAnswer: string;\n\n  @property({ type: String })\n  currentRightAnswer: string;\n\n  @property({ type: Number })\n  numberOfSolutionsGenerations = 0;\n\n  @property({ type: Number })\n  numberOfPoliciesIdeasGeneration = 0;\n\n  @property({ type: Number })\n  totalSolutions = 0;\n\n  @property({ type: Number })\n  totalPros = 0;\n\n  @property({ type: Number })\n  totalCons = 0;\n\n  drawer: MdNavigationDrawer;\n\n  constructor() {\n    super();\n\n    window.psServerApi = new PsServerApi();\n    window.psAppGlobals = new PsAppGlobals(window.psServerApi);\n    window.appUser = new PsAppUser(window.psServerApi);\n\n    // Set this.themeDarkMode from localStorage or otherwise to true\n    const savedDarkMode = localStorage.getItem('md3-ps-dark-mode');\n    if (savedDarkMode) {\n      this.themeDarkMode = true;\n    } else {\n      this.themeDarkMode = false;\n    }\n\n    const savedHighContrastMode = localStorage.getItem(\n      'md3-ps-high-contrast-mode'\n    );\n    if (savedHighContrastMode) {\n      this.themeHighContrast = true;\n    } else {\n      this.themeHighContrast = false;\n    }\n\n    window.psAppGlobals.activity('pageview');\n\n    this.setupDebugScroll();\n  }\n\n  setupDebugScroll() {\n    let isScrolling = false;\n    let scrollInterval: string | number | NodeJS.Timeout;\n\n    const startScrolling = () => {\n      if (!isScrolling) {\n        isScrolling = true;\n        scrollInterval = setInterval(() => {\n          window.scrollBy(0, 1); // Scroll down by 10 pixels\n        }, 4); // Every 100 milliseconds\n      }\n    };\n\n    const stopScrolling = () => {\n      if (isScrolling) {\n        clearInterval(scrollInterval);\n        isScrolling = false;\n      }\n    };\n\n    window.addEventListener('keydown', (event) => {\n      if (event.key === 's' && !isScrolling) {\n        startScrolling();\n      }\n    });\n\n    window.addEventListener('keyup', (event) => {\n      if (event.key === 's') {\n        stopScrolling();\n      }\n    });\n  }\n\n\n  renderSolutionPage() {\n    return this.renderContentOrLoader(html`\n      <div class=\"layout horizontal\">\n        ${this.currentMemory\n          ? html`\n              ${this.renderNavigationBar()}\n              <div class=\"rightPanel\">\n                <main>\n                  <div class=\"mainPageContainer\">\n                    <ps-solutions\n                      .memory=\"${this.currentMemory}\"\n                      .activeSubProblemIndex=\"${this.activeSubProblemIndex}\"\n                      .activePopulationIndex=\"${this.activePopulationIndex}\"\n                      .activeSolutionIndex=\"${this.activeSolutionIndex}\"\n                      @update-route=\"${this.updateActiveSolutionIndexes}\"\n                      .router=\"${this.router}\"\n                    ></ps-solutions>\n                  </div>\n                </main>\n              </div>\n            `\n          : nothing}\n      </div>\n    `);\n  }\n\n  renderPoliciesPage() {\n    return this.renderContentOrLoader(html`\n      <div class=\"layout horizontal\">\n        ${this.currentMemory\n          ? html`\n              ${this.renderNavigationBar()}\n              <div class=\"rightPanel\">\n                <main>\n                  <div class=\"mainPageContainer\">\n                    <ps-policies\n                      .memory=\"${this.currentMemory}\"\n                      .activeSubProblemIndex=\"${this.activeSubProblemIndex}\"\n                      .activePopulationIndex=\"${this.activePopulationIndex}\"\n                      .activePolicyIndex=\"${this.activePolicyIndex}\"\n                      @update-route=\"${this.updateActivePolicyIndexes}\"\n                      .router=\"${this.router}\"\n                    ></ps-policies>\n                  </div>\n                </main>\n              </div>\n            `\n          : nothing}\n      </div>\n    `);\n  }\n\n  setupCurrentProjectFromRoute(newProjectId: number, clearAll = false) {\n    if (newProjectId !== this.currentProjectId) {\n      this.currentProjectId = newProjectId;\n      this.boot();\n    }\n\n    if (clearAll) {\n      this.activeSubProblemIndex = null;\n      this.activePopulationIndex = null;\n      this.activeSolutionIndex = null;\n      this.activePolicyIndex = null;\n    }\n\n    if (!this.wide) {\n      setTimeout(() => {\n        if (window.location.pathname.indexOf('webResearch') > -1) {\n          if (this.$$('#navBar') as NavigationBar) {\n            (this.$$('#navBar') as NavigationBar).activeIndex = 0;\n          }\n        } else if (window.location.pathname.indexOf('solutions') > -1) {\n          if (this.$$('#navBar') as NavigationBar) {\n            (this.$$('#navBar') as NavigationBar).activeIndex = 1;\n          }\n        } else if (window.location.pathname.indexOf('policies') > -1) {\n          if (this.$$('#navBar') as NavigationBar) {\n            (this.$$('#navBar') as NavigationBar).activeIndex = 2;\n          }\n        }\n      }, 100);\n    }\n  }\n\n  parseAllActiveIndexes(params: any) {\n    this.activeSubProblemIndex = params.subProblemIndex\n      ? parseInt(params.subProblemIndex, 10)\n      : null;\n    this.activePopulationIndex = params.populationIndex\n      ? parseInt(params.populationIndex, 10)\n      : null;\n    this.activeSolutionIndex = params.solutionIndex\n      ? parseInt(params.solutionIndex, 10)\n      : null;\n    this.activePolicyIndex = params.policyIndex\n      ? parseInt(params.policyIndex, 10)\n      : null;\n  }\n\n  router: PsRouter = new PsRouter(\n    this,\n    [\n      {\n        path: '/',\n        render: () => {\n          return html`<ps-home .memory=\"${this.currentMemory}\"></ps-home>`;\n        },\n      },\n      // Next two are depricated\n      {\n        path: '/projects/:projectId',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1,\n            true\n          );\n          return this.renderSolutionPage();\n        },\n      },\n      {\n        path: '/projects/:projectId/',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1,\n            true\n          );\n\n          return this.renderSolutionPage();\n        },\n      },\n      {\n        path: '/solutions/:projectId',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1,\n            true\n          );\n          return this.renderSolutionPage();\n        },\n      },\n      {\n        path: '/solutions/:projectId/',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1,\n            true\n          );\n\n          return this.renderSolutionPage();\n        },\n      },\n      {\n        path: '/crt/:treeId/',\n        render: params => {\n          return this.renderCrtPage(params.treeId);\n        },\n      },\n      {\n        path: '/crt/:treeId',\n        render: params => {\n          return this.renderCrtPage(params.treeId);\n        },\n      },\n      {\n        path: '/crt',\n        render: params => {\n          return this.renderCrtPage();\n        },\n      },\n      {\n        path: '/crt/',\n        render: params => {\n          return this.renderCrtPage();\n        },\n      },\n      {\n        path: '/policies/:projectId',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1,\n            true\n          );\n          return this.renderPoliciesPage();\n        },\n      },\n      {\n        path: '/policies/:projectId/',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1,\n            true\n          );\n\n          return this.renderPoliciesPage();\n        },\n      },\n      {\n        path: '/projects/:projectId/refresh827cDb',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1,\n            true\n          );\n          return this.renderSolutionPage();\n        },\n      },\n      // Next two are depricated but kept of backwards compatibility\n      {\n        path: '/projects/:projectId/:subProblemIndex?/:populationIndex?/:solutionIndex?',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1\n          );\n          this.parseAllActiveIndexes(params);\n          return this.renderSolutionPage();\n        },\n      },\n      {\n        path: '/projects/:projectId/:subProblemIndex?/:populationIndex?/:solutionIndex?/',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1\n          );\n          this.parseAllActiveIndexes(params);\n          return this.renderSolutionPage();\n        },\n      },\n      {\n        path: '/solutions/:projectId/:subProblemIndex?/:populationIndex?/:solutionIndex?',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1\n          );\n          this.parseAllActiveIndexes(params);\n          return this.renderSolutionPage();\n        },\n      },\n      {\n        path: '/solutions/:projectId/:subProblemIndex?/:populationIndex?/:solutionIndex?/',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1\n          );\n          this.parseAllActiveIndexes(params);\n          return this.renderSolutionPage();\n        },\n      },\n      {\n        path: '/policies/:projectId/:subProblemIndex?/:populationIndex?/:policyIndex?',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1\n          );\n          this.parseAllActiveIndexes(params);\n          return this.renderPoliciesPage();\n        },\n      },\n      {\n        path: '/policies/:projectId/:subProblemIndex?/:populationIndex?/:policyIndex?/',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1\n          );\n          this.parseAllActiveIndexes(params);\n          return this.renderPoliciesPage();\n        },\n      },\n      {\n        path: '/webResearch/:projectId',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1\n          );\n\n          return this.renderWebResearchPage();\n        },\n      },\n      {\n        path: '/webResearch/:projectId/',\n        render: params => {\n          this.setupCurrentProjectFromRoute(\n            parseInt(params.projectId, 10) || 1\n          );\n\n          return this.renderWebResearchPage();\n        },\n      },\n    ],\n    {\n      fallback: {\n        render: () => html`<h2>Page not found</h2>`,\n      },\n    }\n  );\n\n  renderCrtPage(treeId: string | undefined = undefined) {\n    return html`\n      <ltp-manage-crt\n        .currentTreeId=\"${treeId}\"\n        .themeDarkMode=\"${this.themeDarkMode}\"\n        =\"${treeId}\"\n      ></ltp-manage-crt>\n    `;\n  }\n\n  renderWebResearchPage() {\n    return this.renderContentOrLoader(html`\n      <div class=\"layout horizontal\">\n        ${this.currentMemory\n          ? html`\n              ${this.renderNavigationBar()}\n              <div class=\"rightPanel\">\n                <main>\n                  <div class=\"mainPageContainer\">\n                    <ps-web-research\n                      .memory=\"${this.currentMemory}\"\n                      .router=\"${this.router}\"\n                    ></ps-web-research>\n                  </div>\n                </main>\n              </div>\n            `\n          : nothing}\n      </div>\n    `);\n  }\n\n  getServerUrlFromClusterId(clusterId: number) {\n    if (clusterId == 1) {\n      return 'https://betrireykjavik.is/api';\n    } else if (clusterId == 3) {\n      return 'https://ypus.org/api';\n    } else {\n      return 'https://yrpri.org/api';\n    }\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._setupEventListeners();\n\n    const savedColor = localStorage.getItem(this.localStorageThemeColorKey);\n    if (savedColor) {\n      this.fireGlobal('yp-theme-color', savedColor);\n    }\n\n    this.setupTheme();\n  }\n\n  openTempPassword() {\n    this.tempPassword = undefined;\n    (this.$$('#tempPassword') as TextField).value = '';\n    (this.$$('#tempPasswordDialog') as Dialog).open = true;\n  }\n\n  async boot() {\n    window.psAppGlobals.activity('Boot - fetch start');\n    const firstBootResponse = (await window.psServerApi.getProject(\n      this.currentProjectId,\n      this.tempPassword,\n      location.pathname.indexOf('refresh827cDb') > -1 ? '999' : undefined\n    )) as CpsBootResponse | { needsTrm: boolean };\n\n    if (firstBootResponse && 'needsTrm' in firstBootResponse) {\n      if (this.tempPassword) {\n        await new Promise(resolve => setTimeout(resolve, 2000));\n      }\n      window.psAppGlobals.activity('Boot - needs trm');\n      this.openTempPassword();\n    } else {\n      const bootResponse = firstBootResponse as CpsBootResponse;\n\n      this.currentMemory = bootResponse.currentMemory;\n\n      if (this.currentMemory.subProblems[0].solutions) {\n        this.numberOfSolutionsGenerations =\n          this.currentMemory.subProblems[0].solutions.populations.length;\n      }\n\n      if (this.currentMemory.subProblems[0].policies) {\n        this.numberOfPoliciesIdeasGeneration =\n          this.currentMemory.subProblems[0].policies.populations.length;\n      }\n\n      document.title = bootResponse.name;\n\n      if (bootResponse.isAdmin === true) {\n        this.isAdmin = true;\n      } else {\n        this.isAdmin = false;\n      }\n\n      this.themeColor = bootResponse.configuration.theme_color\n        ? bootResponse.configuration.theme_color\n        : '#df2302';\n      this.themePrimaryColor = bootResponse.configuration.theme_primary_color;\n      this.themeSecondaryColor =\n        bootResponse.configuration.theme_secondary_color;\n      this.themeTertiaryColor = bootResponse.configuration.theme_tertiary_color;\n      this.themeNeutralColor = bootResponse.configuration.theme_neutral_color;\n      this.themeScheme = bootResponse.configuration.theme_scheme\n        ? bootResponse.configuration.theme_scheme.toLowerCase()\n        : 'tonal';\n\n      this.themeChanged();\n\n      for (let subProblem of this.currentMemory.subProblems) {\n        if (subProblem.solutions && subProblem.solutions.populations) {\n          for (let population of subProblem.solutions.populations) {\n            this.totalSolutions += population.length;\n\n            for (let solution of population) {\n              if (Array.isArray(solution.pros)) {\n                this.totalPros += solution.pros.length;\n              }\n              if (Array.isArray(solution.cons)) {\n                this.totalCons += solution.cons.length;\n              }\n            }\n          }\n        }\n      }\n\n      window.psAppGlobals.activity('Boot - fetch end');\n    }\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this._removeEventListeners();\n  }\n\n  getHexColor(color: string) {\n    if (color) {\n      // Replace all # with nothing\n      color = color.replace(/#/g, '');\n      if (color.length === 6) {\n        return `#${color}`;\n      } else {\n        return undefined;\n      }\n    } else {\n      return undefined;\n    }\n  }\n\n  themeChanged(target: HTMLElement | undefined = undefined) {\n    let themeCss = {} as any;\n\n    // Save this.themeColor to locale storage\n    localStorage.setItem(this.localStorageThemeColorKey, this.themeColor);\n\n    const isDark =\n      this.themeDarkMode === undefined\n        ? window.matchMedia('(prefers-color-scheme: dark)').matches\n        : this.themeDarkMode;\n\n    if (this.isAppleDevice) {\n      const theme = themeFromSourceColor(\n        argbFromHex(this.themeColor || this.themePrimaryColor || '#000000'),\n        [\n          {\n            name: 'up-vote',\n            value: argbFromHex('#0F0'),\n            blend: true,\n          },\n          {\n            name: 'down-vote',\n            value: argbFromHex('#F00'),\n            blend: true,\n          },\n        ]\n      );\n\n      applyTheme(theme, { target: document.body, dark: isDark });\n    } else {\n      if (this.getHexColor(this.themeColor)) {\n        themeCss = themeFromSourceColorWithContrast(\n          this.getHexColor(this.themeColor),\n          isDark,\n          this.themeScheme,\n          this.themeHighContrast ? 2.0 : 0.0\n        );\n      } else {\n        themeCss = themeFromSourceColorWithContrast(\n          {\n            primary: this.getHexColor(this.themePrimaryColor || '#000000'),\n            secondary: this.getHexColor(this.themeSecondaryColor || '#000000'),\n            tertiary: this.getHexColor(this.themeTertiaryColor || '#000000'),\n            neutral: this.getHexColor(this.themeNeutralColor || '#000000'),\n          },\n          isDark,\n          'dynamic',\n          this.themeHighContrast ? 2.0 : 0.0\n        );\n      }\n\n      applyThemeWithContrast(document, themeCss);\n    }\n  }\n\n  snackbarclosed() {\n    this.lastSnackbarText = undefined;\n  }\n\n  tabChanged(event: CustomEvent) {\n    if (event.detail.activeIndex == 0) {\n      this.pageIndex = 1;\n    } else if (event.detail.activeIndex == 1) {\n      this.pageIndex = 2;\n    } else if (event.detail.activeIndex == 2) {\n      this.pageIndex = 3;\n    } else if (event.detail.activeIndex == 3) {\n      this.pageIndex = 4;\n    }\n  }\n\n  mobileTabChanged(event: CustomEvent) {\n    if (event.detail.activeIndex == 3) {\n      (event.target as NavigationBar).activeIndex = 1;\n    }\n    /*\n    if (event.detail.activeIndex == 0) {\n      this.openSolutions();\n    } else if (event.detail.activeIndex == 1) {\n      //this.openPolicies();\n    } else if (event.detail.activeIndex == 2) {\n      this.openWebResearch();\n    } else if (event.detail.activeIndex == 3) {\n      this.openGitHub();\n      (event.target as NavigationBar).activeIndex = 1;\n      this.pageIndex = PagesTypes.Solutions;\n    }*/\n  }\n\n  exitToMainApp() {\n    window.location.href = `/`;\n  }\n\n  async _displaySnackbar(event: CustomEvent) {\n    this.lastSnackbarText = event.detail;\n    await this.updateComplete;\n    (this.$$('#snackbar') as Snackbar).show();\n  }\n\n  _setupEventListeners() {\n    this.addListener('app-error', this._appError);\n    this.addListener('display-snackbar', this._displaySnackbar);\n    this.addListener('toggle-dark-mode', this.toggleDarkMode.bind(this));\n    this.addListener(\n      'toggle-high-contrast-mode',\n      this.toggleHighContrastMode.bind(this)\n    );\n\n    window.addEventListener('popstate', () => {\n      //console.error(`pop state ${window.location.pathname}`)\n      this.router.goto(window.location.pathname);\n      this.requestUpdate();\n    });\n  }\n\n  _removeEventListeners() {\n    this.removeListener('display-snackbar', this._displaySnackbar);\n    this.removeListener('app-error', this._appError);\n    this.removeListener('toggle-dark-mode', this.toggleDarkMode.bind(this));\n    this.removeListener(\n      'toggle-high-contrast-mode',\n      this.toggleHighContrastMode.bind(this)\n    );\n  }\n\n  async updateActiveSolutionIndexes(event: CustomEvent) {\n    this.activeSubProblemIndex = event.detail.activeSubProblemIndex;\n    this.activePopulationIndex = event.detail.activePopulationIndex;\n    this.activeSolutionIndex = event.detail.activeSolutionIndex;\n    await this.updateSolutionsRouter();\n    /*console.error(\n      `updateActiveSolutionIndexes ${this.activeSubProblemIndex} ${this.activePopulationIndex} ${this.activeSolutionIndex}`\n    )*/\n  }\n\n  async updateActivePolicyIndexes(event: CustomEvent) {\n    this.activeSubProblemIndex = event.detail.activeSubProblemIndex;\n    this.activePopulationIndex = event.detail.activePopulationIndex;\n    this.activePolicyIndex = event.detail.activePolicyIndex;\n    await this.updatePoliciesRouter();\n  }\n\n  async updatePoliciesRouter() {\n    let path: string;\n    if (\n      this.activePolicyIndex !== null &&\n      this.activeSubProblemIndex !== null &&\n      this.activePopulationIndex !== null\n    ) {\n      path = `/policies/${this.currentProjectId}/${this.activeSubProblemIndex}/${this.activePopulationIndex}/${this.activePolicyIndex}`;\n    } else if (\n      this.activeSubProblemIndex !== null &&\n      this.activePopulationIndex !== null\n    ) {\n      path = `/policies/${this.currentProjectId}/${this.activeSubProblemIndex}/${this.activePopulationIndex}`;\n    } else if (\n      this.activeSubProblemIndex !== null &&\n      this.activeSubProblemIndex !== undefined\n    ) {\n      path = `/policies/${this.currentProjectId}/${this.activeSubProblemIndex}`;\n    } else {\n      path = `/policies/${this.currentProjectId}`;\n    }\n\n    await this.router.goto(path);\n\n    setTimeout(() => {\n      if (window.location.pathname != path) {\n        history.pushState({}, '', path);\n        //console.error(`push state ${path}`)\n      }\n      this.requestUpdate();\n    });\n  }\n\n  async updateSolutionsRouter() {\n    let path: string;\n    if (\n      this.activePolicyIndex !== null &&\n      this.activeSubProblemIndex !== null &&\n      this.activePopulationIndex !== null\n    ) {\n      path = `/policies/${this.currentProjectId}/${this.activeSubProblemIndex}/${this.activePopulationIndex}/${this.activePolicyIndex}`;\n    } else if (\n      this.activeSolutionIndex !== null &&\n      this.activeSubProblemIndex !== null &&\n      this.activePopulationIndex !== null\n    ) {\n      path = `/solutions/${this.currentProjectId}/${this.activeSubProblemIndex}/${this.activePopulationIndex}/${this.activeSolutionIndex}`;\n    } else if (\n      this.activeSubProblemIndex !== null &&\n      this.activePopulationIndex !== null\n    ) {\n      path = `/solutions/${this.currentProjectId}/${this.activeSubProblemIndex}/${this.activePopulationIndex}`;\n    } else if (\n      this.activeSubProblemIndex !== null &&\n      this.activeSubProblemIndex !== undefined\n    ) {\n      path = `/solutions/${this.currentProjectId}/${this.activeSubProblemIndex}`;\n    } else {\n      path = `/solutions/${this.currentProjectId}`;\n    }\n\n    await this.router.goto(path);\n\n    setTimeout(() => {\n      if (window.location.pathname != path) {\n        history.pushState({}, '', path);\n        //console.error(`push state ${path}`)\n      }\n      this.requestUpdate();\n    });\n  }\n\n  updated(changedProperties: Map<string | number | symbol, unknown>): void {\n    super.updated(changedProperties);\n    if (\n      changedProperties.has('themeColor') ||\n      changedProperties.has('themeDarkMode')\n    ) {\n      this.themeChanged();\n    }\n  }\n\n  _appError(event: CustomEvent) {\n    console.error(event.detail.message);\n    this.currentError = event.detail.message;\n    //(this.$$('#errorDialog') as Dialog).open = true;\n  }\n\n  get adminConfirmed() {\n    return true;\n  }\n\n  _settingsColorChanged(event: CustomEvent) {\n    this.fireGlobal('yp-theme-color', event.detail.value);\n  }\n\n  static get styles() {\n    return [\n      Layouts,\n      css`\n        :host {\n          background-color: var(--md-sys-color-background, #fefefe);\n        }\n\n        :host {\n        }\n\n        .costsContainer {\n          margin-top: 32px;\n          opacity: 0.7;\n          font-size: 13px;\n        }\n\n        a {\n          color: var(--md-sys-color-on-surface);\n          margin-top: 8px;\n        }\n\n        body {\n          background-color: var(--md-sys-color-background, #fefefe);\n        }\n\n        .analyticsHeaderText {\n          font-size: var(--md-sys-typescale-headline-large-size, 18px);\n          margin-top: 16px;\n          margin-bottom: 16px;\n        }\n\n        .appTitleContainer {\n          margin-bottom: 0px;\n          margin-top: 16px;\n          font-family: 'Cabin', sans-serif;\n          font-size: 22px;\n          width: 185px;\n          background-color: var(--md-sys-color-primary);\n          color: var(--md-sys-color-on-primary);\n          border-top-left-radius: 24px;\n          border-top-right-radius: 24px;\n        }\n\n        .appTitle {\n          padding: 16px;\n          margin-left: 4px;\n          padding-top: 20px;\n        }\n\n        md-outlined-text-field {\n          margin: 32px;\n        }\n\n        md-elevated-button {\n          margin-bottom: 16px;\n        }\n\n        .ypLogo {\n          margin-top: 16px;\n        }\n\n        .rightPanel {\n          width: 100%;\n        }\n\n        .drawer {\n          margin-left: 16px;\n          padding-left: 8px;\n          margin-right: 16px;\n          padding-bottom: 560px;\n        }\n\n        .costItem {\n          margin-bottom: 8px;\n          margin-left: 8px;\n          color: var(--md-sys-color-on-surface);\n        }\n\n        .statsItem {\n          margin-bottom: 6px;\n          margin-left: 8px;\n          color: var(--md-sys-color-on-surface);\n        }\n\n        .statsContainer {\n          margin-bottom: 16px;\n        }\n\n        .selectedContainer {\n          /*--md-list-item-list-item-container-color: var(--md-sys-color-surface-variant);*/\n          color: var(--md-sys-color-primary);\n          --md-list-item-list-item-label-text-color: var(\n            --md-sys-color-primary\n          );\n          --md-list-item-list-item-focus-label-text-color: var(\n            --md-sys-color-primary\n          );\n          --md-list-item-label-text-color: var(--md-sys-color-primary);\n        }\n\n        md-navigation-drawer {\n          --md-navigation-drawer-container-color: var(--md-sys-color-surface);\n        }\n\n        md-list {\n          --md-list-container-color: var(--md-sys-color-surface);\n        }\n\n        md-navigation-bar {\n          --md-navigation-bar-container-color: var(--md-sys-color-surface);\n        }\n\n        .loading {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          width: 100%;\n          height: 100vh;\n        }\n\n        .lightDarkContainer {\n          padding-left: 8px;\n          padding-right: 8px;\n          color: var(--md-sys-color-on-background);\n          font-size: 14px;\n        }\n\n        .darkModeButton {\n          margin: 16px;\n        }\n\n        .topAppBar {\n          border-radius: 48px;\n          background-color: var(--md-sys-color-primary-container);\n          color: var(--md-sys-color-on-primary-container);\n          margin-top: 32px;\n          padding: 0px;\n          padding-left: 32px;\n          padding-right: 32px;\n          text-align: center;\n        }\n\n        .collectionLogoImage {\n          width: 185px;\n          height: 104px;\n          margin-top: -1px;\n        }\n\n        .mainPageContainer {\n          margin-top: 16px;\n        }\n\n        .version {\n          margin: 8px;\n          margin-top: 32px;\n          font-size: 12px;\n          margin-bottom: 32px;\n          color: var(--md-sys-color-on-surface);\n        }\n\n        .navContainer {\n          position: fixed;\n          bottom: 0;\n          left: 0;\n          width: 100%;\n          z-index: 7;\n        }\n\n        [hidden] {\n          display: none !important;\n        }\n\n        md-text-button {\n          --md-text-button-label-text-color: #fefefe;\n        }\n\n        md-icon-button {\n          --md-icon-button-unselected-icon-color: #f0f0f0;\n        }\n\n        #goalTriggerSnackbar {\n          padding: 24px;\n        }\n\n        @media (max-width: 960px) {\n          .appTitleContainer {\n            margin-top: 32px;\n          }\n          .mainPageContainer {\n            max-width: 100%;\n            width: 100%;\n            margin-bottom: 96px;\n            margin-top: 0;\n          }\n\n          prompt-promotion-dashboard {\n            max-width: 100%;\n          }\n        }\n      `,\n    ];\n  }\n\n  changeTabTo(tabId: number) {\n    this.tabChanged({ detail: { activeIndex: tabId } } as CustomEvent);\n  }\n\n  updateThemeColor(event: CustomEvent) {\n    this.themeColor = event.detail;\n  }\n\n  sendVoteAnalytics() {\n    if (this.totalNumberOfVotes % 10 === 0) {\n      window.psAppGlobals.activity(\n        `User voted ${this.totalNumberOfVotes} times`\n      );\n    }\n  }\n\n  renderIntroduction() {\n    return html` <div class=\"layout vertical center-center\"></div> `;\n  }\n\n  renderShare() {\n    return html` <div class=\"layout vertical center-center\"></div> `;\n  }\n\n  toggleDarkMode() {\n    this.themeDarkMode = !this.themeDarkMode;\n    if (this.themeDarkMode) {\n      window.psAppGlobals.activity('Settings - dark mode');\n      localStorage.setItem('md3-ps-dark-mode', 'true');\n    } else {\n      window.psAppGlobals.activity('Settings - light mode');\n      localStorage.removeItem('md3-ps-dark-mode');\n    }\n    this.themeChanged();\n  }\n\n  toggleHighContrastMode() {\n    this.themeHighContrast = !this.themeHighContrast;\n    if (this.themeHighContrast) {\n      window.psAppGlobals.activity('Settings - high contrast mode');\n      localStorage.setItem('md3-ps-high-contrast-mode', 'true');\n    } else {\n      window.psAppGlobals.activity('Settings - non high contrast mode');\n      localStorage.removeItem('md3-ps-high-contrast-mode');\n    }\n    this.themeChanged();\n  }\n\n  setupTheme() {\n    // Read dark mode and theme from localestore and set this.themeDarkMode and this.themeColor and change the theme\n    const savedDarkMode = localStorage.getItem('md3-ps-dark-mode');\n    if (savedDarkMode) {\n      this.themeDarkMode = true;\n    } else {\n      this.themeDarkMode = false;\n    }\n\n    const savedHighContrastMode = localStorage.getItem(\n      'md3-ps-high-contrast-mode'\n    );\n\n    if (savedHighContrastMode) {\n      this.themeHighContrast = true;\n    } else {\n      this.themeHighContrast = false;\n    }\n\n    const savedThemeColor = localStorage.getItem(\n      this.localStorageThemeColorKey\n    );\n    if (savedThemeColor) {\n      this.themeColor = savedThemeColor;\n    }\n\n    this.fire('yp-theme-dark-mode', this.themeDarkMode);\n\n    this.themeChanged();\n  }\n\n  startVoting() {\n    this.pageIndex = 2;\n    if (this.$$('#navBar') as NavigationBar) {\n      (this.$$('#navBar') as NavigationBar).activeIndex = 1;\n    }\n  }\n\n  openResults() {\n    this.pageIndex = 3;\n    if (this.$$('#navBar') as NavigationBar) {\n      (this.$$('#navBar') as NavigationBar).activeIndex = 2;\n    }\n  }\n\n  openAnalytics() {\n    //window.location.href = `/analytics`;\n  }\n\n  goToAdmin() {\n    //window.location.href = `/admin`;\n  }\n\n  openGitHub() {\n    // Open up in a new tab\n    window.open('https://github.com/CitizensFoundation/policy-synth', '_blank');\n  }\n\n  stageModelMap = {\n    createSubProblems: PsConstants.createSubProblemsModel,\n    createEntities: PsConstants.createEntitiesModel,\n    rankWebSolutions: PsConstants.rankWebSolutionsModel,\n    analyseExternalSolutions: PsConstants.analyseExternalSolutionsModel,\n    createSearchQueries: PsConstants.createSearchQueriesModel,\n    createSolutionImages: PsConstants.createSolutionImagesModel,\n    createProblemStatementImage: PsConstants.createSolutionImagesModel,\n    createSubProblemImages: PsConstants.createSolutionImagesModel,\n    rankSearchResults: PsConstants.searchResultsRankingsModel,\n    policiesSeed: PsConstants.policiesSeedModel,\n    policiesCreateImages: PsConstants.createSolutionImagesModel,\n    rankSearchQueries: PsConstants.searchQueryRankingsModel,\n    rankSubProblems: PsConstants.subProblemsRankingsModel,\n    rankEntities: PsConstants.entitiesRankingsModel,\n    rankSolutions: PsConstants.solutionsRankingsModel,\n    rankProsCons: PsConstants.prosConsRankingsModel,\n    evolveReapPopulation: PsConstants.reapSolutionsModel,\n    rateSolutions: PsConstants.rateSolutionsModel,\n    alidationAgent: PsConstants.validationModel,\n    groupSolutions: PsConstants.groupSolutionsModel,\n    evolveCreatePopulation: PsConstants.evolveSolutionsModel,\n    evolveMutatePopulation: PsConstants.evolutionMutateModel,\n    evolveRecombinePopulation: PsConstants.evolutionRecombineModel,\n    evolveRankPopulation: PsConstants.solutionsRankingsModel,\n    webSearch: PsConstants.createSearchQueriesModel, // Not sure about this mapping\n    webGetPages: PsConstants.getPageAnalysisModel,\n    webGetEvidencePages: PsConstants.getPageAnalysisModel,\n    webGetRefinedEvidence: PsConstants.getRefinedEvidenceModel,\n    webGetRefinedRootCauses: PsConstants.getRefinedRootCausesModel,\n    rankWebRootCauses: PsConstants.rankWebRootCausesModel,\n    rateWebRootCauses: PsConstants.rateWebRootCausesModel,\n    rankWebEvidence: PsConstants.rankWebEvidenceModel,\n    reduceSubProblems: PsConstants.reduceSubProblemsModel,\n    createRootCausesSearchQueries: PsConstants.createSearchQueriesModel,\n    rateWebEvidence: PsConstants.rateWebEvidenceModel,\n    webGetRootCausesPages: PsConstants.getPageAnalysisModel,\n    createSeedSolutions: PsConstants.createSolutionsModel,\n    createEvidenceSearchQueries: PsConstants.createSearchQueriesModel,\n    createProsCons: PsConstants.createProsConsModel,\n    parse: PsConstants.createSubProblemsModel, // Not sure about this mapping\n    save: PsConstants.createSubProblemsModel, // Not sure about this mapping\n    done: PsConstants.createSubProblemsModel, // Not sure about this mapping\n  };\n\n  toCamelCase(str: string) {\n    return str.replace(/-([a-z])/g, function (g) {\n      return g[1].toUpperCase();\n    });\n  }\n\n  renderStats() {\n    return html`\n      <div class=\"layout vertical statsContainer\">\n        <div class=\"statsItem\">\n          ${this.t('Total solutions')}:\n          ${YpFormattingHelpers.number(this.totalSolutions)}\n        </div>\n        <div class=\"statsItem\">\n          ${this.t('Total pros')}: ${YpFormattingHelpers.number(this.totalPros)}\n        </div>\n        <div class=\"statsItem\">\n          ${this.t('Total cons')}: ${YpFormattingHelpers.number(this.totalCons)}\n        </div>\n        <div class=\"statsItem\">\n          ${this.t('Solutions generations')}:\n          ${YpFormattingHelpers.number(this.numberOfSolutionsGenerations)}\n        </div>\n        <div class=\"statsItem\">\n          ${this.t('Policies generations')}:\n          ${YpFormattingHelpers.number(this.numberOfPoliciesIdeasGeneration)}\n        </div>\n      </div>\n    `;\n  }\n\n  renderCosts() {\n    // Calculate total cost\n    let totalCost = 0;\n    let gpt4Cost = 0;\n    let gpt35Cost = 0;\n    let gpt35_16kCost = 0;\n\n    try {\n      Object.keys(this.currentMemory.stages).forEach(stage => {\n        //@ts-ignore\n        const stageData = this.currentMemory.stages[stage];\n        if (stageData) {\n          if (stageData.tokensInCost && stageData.tokensOutCost) {\n            const stageCost = stageData.tokensInCost + stageData.tokensOutCost;\n            totalCost += stageCost;\n            // Calculate costs for each model\n            const camelCaseStage = this.toCamelCase(stage);\n            //console.error(`stage: ${stage} camelCaseStage: ${camelCaseStage}`)\n\n            //@ts-ignore\n            const modelConstants = this.stageModelMap[camelCaseStage];\n            if (!modelConstants) {\n              console.error(`Can't find stage: ${stage}`);\n            } else {\n              if (\n                modelConstants.name === 'gpt-4' ||\n                modelConstants.name === 'gpt-4-1106-preview'\n              ) {\n                gpt4Cost += stageCost;\n              } else if (\n                modelConstants.name === 'gpt-3.5-turbo' ||\n                modelConstants.name === 'gpt-3.5-turbo-1106'\n              ) {\n                gpt35Cost += stageCost;\n              } else if (modelConstants.name === 'gpt-3.5-turbo-16k') {\n                gpt35_16kCost += stageCost;\n              } else {\n                console.error(`Unknown model name: ${modelConstants.name}`);\n              }\n            }\n          }\n        } else {\n          console.warn(`No stage data for ${stage}`);\n        }\n      });\n    } catch (error: any) {\n      console.error(error.stack || error);\n    }\n\n    // Render total and model costs\n    let costTemplates = [];\n\n    // Render costs for each stage\n    if (this.showAllCosts) {\n      costTemplates.push(\n        html`<div class=\"costItem\">\n          Total cost: $${YpFormattingHelpers.number(totalCost)}\n        </div>`,\n        html`<div class=\"costItem\" style=\"margin-top: 16px\">\n          GPT-4 cost: $${YpFormattingHelpers.number(gpt4Cost)}\n        </div>`\n      );\n      costTemplates.push(\n        html`<div class=\"costItem\">\n          GPT-3.5 cost: $${YpFormattingHelpers.number(gpt35Cost)}\n        </div>`\n      );\n      costTemplates.push(\n        html`<div class=\"costItem\" style=\"margin-bottom: 16px\">\n          GPT-3.5 16k cost: $${YpFormattingHelpers.number(gpt35_16kCost)}\n        </div>`\n      );\n      const stageCostsArray: { stage: string; cost: any }[] = [];\n      Object.keys(this.currentMemory.stages).forEach(stage => {\n        //@ts-ignore\n        const stageData = this.currentMemory.stages[stage];\n        const stageCost = stageData.tokensInCost + stageData.tokensOutCost;\n        if (!isNaN(stageCost)) {\n          stageCostsArray.push({\n            stage,\n            cost: stageCost,\n          });\n        }\n      });\n\n      // Sorting the array based on stageCost\n      stageCostsArray.sort((a, b) => b.cost - a.cost);\n\n      // Pushing sorted stages to costTemplates\n      stageCostsArray.forEach(item => {\n        costTemplates.push(\n          html`<div class=\"costItem\">\n            $${YpFormattingHelpers.number(item.cost)}-\n            ${this.toCamelCase(item.stage)}\n          </div>`\n        );\n      });\n    }\n\n    if (!this.showAllCosts) {\n      costTemplates.push(\n        html`<div class=\"layout horizontal\">\n          <a href=\"#\" @click=${this.handleShowMore}>Show API cost...</a>\n        </div>`\n      );\n    }\n\n    return html`<div class=\"layout vertical\">${costTemplates}</div>`;\n  }\n\n  renderContentOrLoader(content: TemplateResult) {\n    if (this.currentMemory) {\n      return content;\n    } else {\n      return html`\n        <div class=\"loading\">\n          <md-circular-progress indeterminate></md-circular-progress>\n        </div>\n      `;\n    }\n  }\n\n  handleShowMore(event: CustomEvent) {\n    event.preventDefault();\n    this.showAllCosts = true;\n  }\n\n  getCustomVersion(version: string) {\n    const date = new Date();\n\n    const formattedDate = date.toLocaleString('en-US', {\n      day: 'numeric',\n      month: 'long',\n      year: 'numeric',\n    });\n\n    return `Built on ${formattedDate} CET`;\n  }\n\n  renderThemeToggle(hideText= false) {\n    return html`<div class=\"layout vertical center-center lightDarkContainer\">\n        ${!this.themeDarkMode\n          ? html`\n              <md-outlined-icon-button\n                class=\"darkModeButton\"\n                @click=\"${this.toggleDarkMode}\"\n                ><md-icon>dark_mode</md-icon></md-outlined-icon-button\n              >\n            `\n          : html`\n              <md-outlined-icon-button\n                class=\"darkModeButton\"\n                @click=\"${this.toggleDarkMode}\"\n                ><md-icon>light_mode</md-icon></md-outlined-icon-button\n              >\n            `}\n        <div ?hidden=\"${hideText}\">${this.t('Light/Dark')}</div>\n      </div>\n\n      <div\n        class=\"layout vertical center-center lightDarkContainer\"\n        ?hidden=\"${this.isAppleDevice}\"\n      >\n        ${!this.themeHighContrast\n          ? html`\n            <md-outlined-icon-button\n              class=\"darkModeButton\"\n              @click=\"${this.toggleHighContrastMode}\"\n              ><md-icon>contrast</md-icon></md-outlined-icon-button\n            >\n          </div> `\n          : html`\n              <md-outlined-icon-button\n                class=\"darkModeButton\"\n                @click=\"${this.toggleHighContrastMode}\"\n                ><md-icon>contrast_rtl_off</md-icon></md-outlined-icon-button\n              >\n            `}\n        <div ?hidden=\"${hideText}\">${this.t('Contrast')}</div>\n      </div>`;\n  }\n\n  renderLogo() {\n    return html`\n      <div class=\"appTitleContainer\">\n        <div class=\"appTitle\">${this.t('POLICY SYNTH')}</div>\n      </div>\n      <yp-image\n        class=\"collectionLogoImage\"\n        sizing=\"contain\"\n        src=\"https://yrpri-usa-production-direct-assets.s3.amazonaws.com/Robert_Bjarnason_High_quality_abstract_new_high_tech_new_wave.__61a9b3d8-7533-4841-a99e-ef036fed1fbf.png\"\n      ></yp-image>\n    `;\n  }\n\n  async openSolutions() {\n    this.activeSolutionIndex = null;\n    this.activeSubProblemIndex = null;\n    this.activePopulationIndex = null;\n    this.updateSolutionsRouter();\n    await this.updateComplete;\n    (this.$$('ps-solutions') as PsSolutions)?.reset();\n  }\n\n  async openPolicies() {\n    this.activePolicyIndex = null;\n    this.activeSolutionIndex = null;\n    this.activeSubProblemIndex = null;\n    this.activePopulationIndex = null;\n    this.updatePoliciesRouter();\n    await this.updateComplete;\n    (this.$$('ps-policies') as PsPolicies)?.reset();\n  }\n\n  async openWebResearch() {\n    const path = `/webResearch/${this.currentProjectId}`;\n    this.router.goto(path);\n    setTimeout(() => {\n      if (window.location.pathname != path) {\n        history.pushState({}, '', path);\n        //console.error(`push state ${path}`)\n      }\n      this.requestUpdate();\n    });\n  }\n\n  renderNavigationBar() {\n    if (this.wide) {\n      return html`\n        <div class=\"drawer\">\n          <div class=\"layout horizontal headerContainer center-center\">\n            <div class=\"analyticsHeaderText layout vertical center-center\">\n              ${this.renderLogo()}\n            </div>\n          </div>\n\n          <md-list>\n            <md-list-item\n              type=\"button\"\n              class=\"${\n                location.href.indexOf('/webResearch') > -1 &&\n                'selectedContainer'\n              }\"\n\n              @click=\"${() => this.openWebResearch()}\"\n              @keydown=\"${(e: KeyboardEvent) => {\n                if (e.key === 'Enter') {\n                  this.openWebResearch();\n                }\n              }}\"\n\n            >\n              <div slot=\"headline\">${this.t('Web Research')}</div>\n              <div slot=\"supporting-text\">${this.t('Automated')}</div>\n              <md-icon slot=\"start\">manage_search</md-icon>\n            </md-list-item>\n            <md-list-item\n              type=\"button\"\n              class=\"${\n                location.href.indexOf('/solutions') > -1 && 'selectedContainer'\n              }\"\n\n              @click=\"${async () => {\n                this.openSolutions();\n                setTimeout(() => {\n                  this.requestUpdate();\n                });\n              }}\"\n              @keydown=\"${(e: KeyboardEvent) => {\n                if (e.key === 'Enter') {\n                  this.openSolutions();\n                }\n              }}\"\n            >\n              <div slot=\"headline\">${this.t('Solutions')}</div>\n              <div slot=\"supporting-text\">${\n                this.numberOfSolutionsGenerations\n              } generations</div>\n              <md-icon slot=\"start\">online_prediction</md-icon>\n            </md-list-item>\n            <md-list-item hidden\n              type=\"button\"\n              class=\"${\n                this.pageIndex == PagesTypes.PolicyCategories &&\n                'selectedContainer'\n              }\"\n            >\n              <div slot=\"headline\">${this.t('Policy categories')}</div>\n              <div slot=\"supporting-text\">${this.t('Policy categories')}</div>\n              <md-icon slot=\"start\">category</md-icon>\n            </md-list-item>\n\n            <md-list-item\n              type=\"button\"\n              class=\"${\n                this.pageIndex == PagesTypes.PolicyCategories &&\n                'selectedContainer'\n              }\"\n\n              @click=\"${async () => {\n                this.openPolicies();\n                setTimeout(() => {\n                  this.requestUpdate();\n                });\n              }}\"\n              @keydown=\"${(e: KeyboardEvent) => {\n                if (e.key === 'Enter') {\n                  this.openPolicies();\n                }\n              }}\"\n            >\n              <div slot=\"headline\">${this.t('Policy ideas')}</div>\n              <div slot=\"supporting-text\">${\n                this.numberOfPoliciesIdeasGeneration\n              } generations</div>\n              <md-icon slot=\"start\">policy</md-icon>\n            </md-list-item>\n\n            <md-list-divider></md-list-divider>\n            <md-list-item\n              type=\"button\"\n              ?hidden=\"${true /*!this.isAdmin*/}\"\n              @keydown=\"${(e: KeyboardEvent) => {\n                if (e.key === 'Enter') {\n                  this.openAnalytics();\n                }\n              }}\"\n              @click=\"${this.openAnalytics}\"\n            >\n              <div slot=\"headline\">${this.t('Analytics')}</div>\n              <div slot=\"supporting-text\">${this.t('Admin analytics')}</div>\n              <md-icon slot=\"start\">monitoring</md-icon>\n            </md-list-item>\n            <md-list-item\n              type=\"button\"\n              ?hidden=\"${true /*!this.isAdmin*/}\"\n              @keydown=\"${(e: KeyboardEvent) => {\n                if (e.key === 'Enter') {\n                  this.goToAdmin();\n                }\n              }}\"\n              @click=\"${this.goToAdmin}\"\n            >\n              <div slot=\"headline\">${this.t('Administration')}</div>\n              <div slot=\"supporting-text\">${this.t(\n                'Administer the process'\n              )}</div>\n              <md-icon slot=\"start\">settings</md-icon>\n            </md-list-item>\n            <md-list-divider></md-list-divider>\n            <md-list-item\n              type=\"button\"\n              @keydown=\"${(e: KeyboardEvent) => {\n                if (e.key === 'Enter') {\n                  this.openGitHub();\n                }\n              }}\"\n              @click=\"${this.openGitHub}\"\n            >\n              <div slot=\"headline\">${this.t('Open Source')}</div>\n              <div slot=\"supporting-text\">${this.t('Join us!')}</div>\n              <md-icon slot=\"start\">crowdsource</md-icon></md-list-item>\n            </md-list-item>\n            <div class=\"layout horizontal center-center\">\n              ${this.renderThemeToggle()}\n            </div>\n          </md-list>\n          <div class=\"layout vertical costsContainer\">\n            ${this.renderStats()} ${this.renderCosts()}\n          </div>\n          <div class=\"version\">__VERSION__</div>\n          </div>\n        </div>\n      `;\n    } else {\n      return html`\n        <div class=\"navContainer\">\n          <md-navigation-bar\n            id=\"navBar\"\n            activeIndex=\"1\"\n            @navigation-bar-activated=\"${this.mobileTabChanged}\"\n          >\n            <md-navigation-tab\n              @click=\"${this.openWebResearch}\"\n              .label=\"${this.t('Web Searches')}\"\n              ><md-icon slot=\"activeIcon\">manage_search</md-icon>\n              <md-icon slot=\"inactiveIcon\"\n                >manage_search</md-icon\n              ></md-navigation-tab\n            >\n            <md-navigation-tab\n              @click=\"${this.openSolutions}\"\n              .label=\"${this.t('Solutions')}\"\n              ><md-icon slot=\"activeIcon\">online_prediction</md-icon>\n              <md-icon slot=\"inactiveIcon\"\n                >online_prediction</md-icon\n              ></md-navigation-tab\n            >\n            <md-navigation-tab .label=\"${this.t('Policies')}\"\n              ><md-icon slot=\"activeIcon\">policy</md-icon>\n              <md-icon slot=\"inactiveIcon\">policy</md-icon></md-navigation-tab\n            >\n            <md-navigation-tab\n              @click=\"${this.openGitHub}\"\n              .label=\"${this.t('Open Source')}\"\n              ><md-icon slot=\"activeIcon\">crowdsource</md-icon>\n              <md-icon slot=\"inactiveIcon\"\n                >crowdsource</md-icon\n              ></md-navigation-tab\n            >\n          </md-navigation-bar>\n        </div>\n      `;\n    }\n  }\n\n  submitTempPassword() {\n    this.tempPassword = (this.$$('#tempPassword') as TextField).value;\n    (this.$$('#tempPasswordDialog') as Dialog).open = false;\n    this.boot();\n  }\n\n  renderTempLoginDialog() {\n    return html`<md-dialog\n      id=\"tempPasswordDialog\"\n      @cancel=\"${(e: any) => {\n        e.preventDefault();\n      }}\"\n    >\n      <div slot=\"headline\" class=\"postHeader layout vertical center-center\">\n        ${this.t('Please Enter Password')}\n      </div>\n      <div id=\"content\" slot=\"content\" class=\"layout vertical center-center\">\n        <md-outlined-text-field\n          id=\"tempPassword\"\n          type=\"password\"\n          @keyup=\"${(e: KeyboardEvent) => {\n            if (e.key === 'Enter') {\n              this.submitTempPassword();\n            }\n          }}\"\n        ></md-outlined-text-field>\n        <md-elevated-button @click=\"${this.submitTempPassword}\"\n          >${this.t('Submit')}</md-elevated-button\n        >\n      </div>\n      <div slot=\"footer\"></div>\n    </md-dialog> `;\n  }\n\n  render() {\n    return html`\n    ${this.renderTempLoginDialog()}\n    ${this.router.outlet()}\n\n    </div>\n      ${\n        this.lastSnackbarText\n          ? html`\n              <mwc-snackbar\n                id=\"snackbar\"\n                @MDCSnackbar:closed=\"${this.snackbarclosed}\"\n                style=\"text-align: center;\"\n                .labelText=\"${this.lastSnackbarText}\"\n              ></mwc-snackbar>\n            `\n          : nothing\n      }\n      `;\n  }\n}\n"]}